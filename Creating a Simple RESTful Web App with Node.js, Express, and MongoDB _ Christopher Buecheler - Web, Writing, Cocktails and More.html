<!DOCTYPE html>
<!-- saved from url=(0079)http://cwbuecheler.com/web/tutorials/2014/restful-web-app-node-express-mongodb/ -->
<html class=" js flexbox canvas canvastext webgl no-touch geolocation postmessage websqldatabase indexeddb hashchange history draganddrop websockets rgba hsla multiplebgs backgroundsize borderimage borderradius boxshadow textshadow opacity cssanimations csscolumns cssgradients cssreflections csstransforms csstransforms3d csstransitions fontface generatedcontent video audio localstorage sessionstorage webworkers applicationcache svg inlinesvg smil svgclippaths translated-ltr" style=""><!--<![endif]--><!--
	I LOVE VIEW SOURCE!

	Please feel free to borrow or learn from my markup, scripting, code, CSS ... whatever. It's what makes the web great!

	Uncompressed JS is here: http://cwbuecheler.com/_js/global.js

	For uncompressed SASS files, please contact me. There are too many to link here.

	If you think my source is crappy, please use my contact form to tell me why so that I can learn and improve.

	Thanks,

	-cwb | September 10, 2013
--><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>Creating a Simple RESTful Web App with Node.js, Express, and MongoDB | Christopher Buecheler - Web, Writing, Cocktails and More</title>
	<meta name="description" content="Learn the basics of REST and use them to build an easy, fast, single-page web app.">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="shortcut icon" href="http://cwbuecheler.com/favicon.ico" type="image/vnd.microsoft.icon">
	<link rel="stylesheet" href="http://cwbuecheler.com/_css/style.css?v=2013.09.11">
	<script type="text/javascript" async="" src="./Creating a Simple RESTful Web App with Node.js, Express, and MongoDB _ Christopher Buecheler - Web, Writing, Cocktails and More_files/clickprints.min.js"></script><script type="text/javascript" async="" src="./Creating a Simple RESTful Web App with Node.js, Express, and MongoDB _ Christopher Buecheler - Web, Writing, Cocktails and More_files/ga.js"></script><script id="facebook-jssdk" src="./Creating a Simple RESTful Web App with Node.js, Express, and MongoDB _ Christopher Buecheler - Web, Writing, Cocktails and More_files/sdk.js"></script><script id="twitter-wjs" src="./Creating a Simple RESTful Web App with Node.js, Express, and MongoDB _ Christopher Buecheler - Web, Writing, Cocktails and More_files/widgets.js"></script><script src="./Creating a Simple RESTful Web App with Node.js, Express, and MongoDB _ Christopher Buecheler - Web, Writing, Cocktails and More_files/modernizr-2.6.2.min.js"></script>
<script type="text/javascript" async="" src="./Creating a Simple RESTful Web App with Node.js, Express, and MongoDB _ Christopher Buecheler - Web, Writing, Cocktails and More_files/embed.js"></script><link rel="stylesheet" type="text/css" href="./Creating a Simple RESTful Web App with Node.js, Express, and MongoDB _ Christopher Buecheler - Web, Writing, Cocktails and More_files/prettify.css"><style type="text/css">.fb_hidden{position:absolute;top:-10000px;z-index:10001}.fb_invisible{display:none}.fb_reset{background:none;border:0;border-spacing:0;color:#000;cursor:auto;direction:ltr;font-family:"lucida grande", tahoma, verdana, arial, sans-serif;font-size:11px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:1;margin:0;overflow:visible;padding:0;text-align:left;text-decoration:none;text-indent:0;text-shadow:none;text-transform:none;visibility:visible;white-space:normal;word-spacing:normal}.fb_reset>div{overflow:hidden}.fb_link img{border:none}
.fb_dialog{background:rgba(82, 82, 82, .7);position:absolute;top:-10000px;z-index:10001}.fb_reset .fb_dialog_legacy{overflow:visible}.fb_dialog_advanced{padding:10px;-moz-border-radius:8px;-webkit-border-radius:8px;border-radius:8px}.fb_dialog_content{background:#fff;color:#333}.fb_dialog_close_icon{background:url(http://static.xx.fbcdn.net/rsrc.php/v2/yq/r/IE9JII6Z1Ys.png) no-repeat scroll 0 0 transparent;_background-image:url(http://static.xx.fbcdn.net/rsrc.php/v2/yL/r/s816eWC-2sl.gif);cursor:pointer;display:block;height:15px;position:absolute;right:18px;top:17px;width:15px}.fb_dialog_mobile .fb_dialog_close_icon{top:5px;left:5px;right:auto}.fb_dialog_padding{background-color:transparent;position:absolute;width:1px;z-index:-1}.fb_dialog_close_icon:hover{background:url(http://static.xx.fbcdn.net/rsrc.php/v2/yq/r/IE9JII6Z1Ys.png) no-repeat scroll 0 -15px transparent;_background-image:url(http://static.xx.fbcdn.net/rsrc.php/v2/yL/r/s816eWC-2sl.gif)}.fb_dialog_close_icon:active{background:url(http://static.xx.fbcdn.net/rsrc.php/v2/yq/r/IE9JII6Z1Ys.png) no-repeat scroll 0 -30px transparent;_background-image:url(http://static.xx.fbcdn.net/rsrc.php/v2/yL/r/s816eWC-2sl.gif)}.fb_dialog_loader{background-color:#f6f7f8;border:1px solid #606060;font-size:24px;padding:20px}.fb_dialog_top_left,.fb_dialog_top_right,.fb_dialog_bottom_left,.fb_dialog_bottom_right{height:10px;width:10px;overflow:hidden;position:absolute}.fb_dialog_top_left{background:url(http://static.xx.fbcdn.net/rsrc.php/v2/ye/r/8YeTNIlTZjm.png) no-repeat 0 0;left:-10px;top:-10px}.fb_dialog_top_right{background:url(http://static.xx.fbcdn.net/rsrc.php/v2/ye/r/8YeTNIlTZjm.png) no-repeat 0 -10px;right:-10px;top:-10px}.fb_dialog_bottom_left{background:url(http://static.xx.fbcdn.net/rsrc.php/v2/ye/r/8YeTNIlTZjm.png) no-repeat 0 -20px;bottom:-10px;left:-10px}.fb_dialog_bottom_right{background:url(http://static.xx.fbcdn.net/rsrc.php/v2/ye/r/8YeTNIlTZjm.png) no-repeat 0 -30px;right:-10px;bottom:-10px}.fb_dialog_vert_left,.fb_dialog_vert_right,.fb_dialog_horiz_top,.fb_dialog_horiz_bottom{position:absolute;background:#525252;filter:alpha(opacity=70);opacity:.7}.fb_dialog_vert_left,.fb_dialog_vert_right{width:10px;height:100%}.fb_dialog_vert_left{margin-left:-10px}.fb_dialog_vert_right{right:0;margin-right:-10px}.fb_dialog_horiz_top,.fb_dialog_horiz_bottom{width:100%;height:10px}.fb_dialog_horiz_top{margin-top:-10px}.fb_dialog_horiz_bottom{bottom:0;margin-bottom:-10px}.fb_dialog_iframe{line-height:0}.fb_dialog_content .dialog_title{background:#6d84b4;border:1px solid #3a5795;color:#fff;font-size:14px;font-weight:bold;margin:0}.fb_dialog_content .dialog_title>span{background:url(http://static.xx.fbcdn.net/rsrc.php/v2/yd/r/Cou7n-nqK52.gif) no-repeat 5px 50%;float:left;padding:5px 0 7px 26px}body.fb_hidden{-webkit-transform:none;height:100%;margin:0;overflow:visible;position:absolute;top:-10000px;left:0;width:100%}.fb_dialog.fb_dialog_mobile.loading{background:url(http://static.xx.fbcdn.net/rsrc.php/v2/ya/r/3rhSv5V8j3o.gif) white no-repeat 50% 50%;min-height:100%;min-width:100%;overflow:hidden;position:absolute;top:0;z-index:10001}.fb_dialog.fb_dialog_mobile.loading.centered{max-height:590px;min-height:590px;max-width:500px;min-width:500px}#fb-root #fb_dialog_ipad_overlay{background:rgba(0, 0, 0, .45);position:absolute;left:0;top:0;width:100%;min-height:100%;z-index:10000}#fb-root #fb_dialog_ipad_overlay.hidden{display:none}.fb_dialog.fb_dialog_mobile.loading iframe{visibility:hidden}.fb_dialog_content .dialog_header{-webkit-box-shadow:white 0 1px 1px -1px inset;background:-webkit-gradient(linear, 0% 0%, 0% 100%, from(#738ABA), to(#2C4987));border-bottom:1px solid;border-color:#1d4088;color:#fff;font:14px Helvetica, sans-serif;font-weight:bold;text-overflow:ellipsis;text-shadow:rgba(0, 30, 84, .296875) 0 -1px 0;vertical-align:middle;white-space:nowrap}.fb_dialog_content .dialog_header table{-webkit-font-smoothing:subpixel-antialiased;height:43px;width:100%}.fb_dialog_content .dialog_header td.header_left{font-size:12px;padding-left:5px;vertical-align:middle;width:60px}.fb_dialog_content .dialog_header td.header_right{font-size:12px;padding-right:5px;vertical-align:middle;width:60px}.fb_dialog_content .touchable_button{background:-webkit-gradient(linear, 0% 0%, 0% 100%, from(#4966A6), color-stop(.5, #355492), to(#2A4887));border:1px solid #2f477a;-webkit-background-clip:padding-box;-webkit-border-radius:3px;-webkit-box-shadow:rgba(0, 0, 0, .117188) 0 1px 1px inset, rgba(255, 255, 255, .167969) 0 1px 0;display:inline-block;margin-top:3px;max-width:85px;line-height:18px;padding:4px 12px;position:relative}.fb_dialog_content .dialog_header .touchable_button input{border:none;background:none;color:#fff;font:12px Helvetica, sans-serif;font-weight:bold;margin:2px -12px;padding:2px 6px 3px 6px;text-shadow:rgba(0, 30, 84, .296875) 0 -1px 0}.fb_dialog_content .dialog_header .header_center{color:#fff;font-size:16px;font-weight:bold;line-height:18px;text-align:center;vertical-align:middle}.fb_dialog_content .dialog_content{background:url(http://static.xx.fbcdn.net/rsrc.php/v2/y9/r/jKEcVPZFk-2.gif) no-repeat 50% 50%;border:1px solid #555;border-bottom:0;border-top:0;height:150px}.fb_dialog_content .dialog_footer{background:#f6f7f8;border:1px solid #555;border-top-color:#ccc;height:40px}#fb_dialog_loader_close{float:left}.fb_dialog.fb_dialog_mobile .fb_dialog_close_button{text-shadow:rgba(0, 30, 84, .296875) 0 -1px 0}.fb_dialog.fb_dialog_mobile .fb_dialog_close_icon{visibility:hidden}
.fb_iframe_widget{display:inline-block;position:relative}.fb_iframe_widget span{display:inline-block;position:relative;text-align:justify}.fb_iframe_widget iframe{position:absolute}.fb_iframe_widget_fluid_desktop,.fb_iframe_widget_fluid_desktop span,.fb_iframe_widget_fluid_desktop iframe{max-width:100%}.fb_iframe_widget_fluid_desktop iframe{min-width:220px;position:relative}.fb_iframe_widget_lift{z-index:1}.fb_hide_iframes iframe{position:relative;left:-10000px}.fb_iframe_widget_loader{position:relative;display:inline-block}.fb_iframe_widget_fluid{display:inline}.fb_iframe_widget_fluid span{width:100%}.fb_iframe_widget_loader iframe{min-height:32px;z-index:2;zoom:1}.fb_iframe_widget_loader .FB_Loader{background:url(http://static.xx.fbcdn.net/rsrc.php/v2/y9/r/jKEcVPZFk-2.gif) no-repeat;height:32px;width:32px;margin-left:-16px;position:absolute;left:50%;z-index:4}</style><link type="text/css" rel="stylesheet" charset="UTF-8" href="./Creating a Simple RESTful Web App with Node.js, Express, and MongoDB _ Christopher Buecheler - Web, Writing, Cocktails and More_files/translateelement.css"></head>
<body data-twttr-rendered="true">

<!--[if lt IE 7]>
	<p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
<![endif]-->

<!-- WRAP -->
<div id="siteWrap">

	<!-- BASE CONTAINER -->
	<div class="container">

		<!-- HEADER WRAP -->
		<div class="headerwrap">

			<!-- HEADER -->
			<header class="header web" role="banner">
				<h1><a href="http://cwbuecheler.com/" rel="nofollow"><font><font>cwbuecheler</font></font></a></h1>
				<div class="social">
					<nav role="navigation" class="socialicons clearfix">
						<ul class="clearfix">
							<li><a href="https://twitter.com/cwbuecheler" target="_blank" class="tw ir">Twitter</a></li>
							<li><a href="https://www.facebook.com/pages/Christopher-Buecheler/217775071566560" target="_blank" class="ir fb">Facebook</a></li>
							<li><a href="http://www.linkedin.com/in/cwbuecheler" target="_blank" class="ir ln">Linkedin</a></li>
							<li><a href="http://www.amazon.com/Christopher-Buecheler/e/B004KA4MLE" target="_blank" class="ir az">Amazon</a></li>
							<li><a href="http://about.me/cwbuecheler" target="_blank" class="ir ab">About.me</a></li>
							<li><a href="http://cwbuecheler.tumblr.com/" target="_blank" class="ir tu">Tumblr</a></li>
							<li><a href="http://cwbuecheler.tumblr.com/rss" target="_blank" class="ir rss">RSS</a></li>
						</ul>
					</nav>
				</div>
			</header>
			<!-- /HEADER -->

			<!-- NAV -->
			<nav role="navigation" class="headernav clearfix">
				<ul id="listMainMenu">
					<li><a href="http://cwbuecheler.com/">Home</a></li>
					<li><a href="http://cwbuecheler.com/web/" class="on">Web</a></li>
					<li><a href="http://cwbuecheler.com/writing/">Writing</a></li>
					<li><a href="http://cwbuecheler.com/cocktails/">Cocktails</a></li>
					<li><a href="http://cwbuecheler.com/beer/">Beer</a></li>
					<li><a href="http://cwbuecheler.com/videogames/">Video Games</a></li>
					<li><a href="http://cwbuecheler.com/music/">Music</a></li>
					<li><a href="http://cwbuecheler.com/sports/">Sports</a></li>
					<li><a href="http://cwbuecheler.com/contact/">Contact</a></li>
				</ul>
			</nav>
			<!-- /NAV -->

		</div>
		<!-- /HEADER WRAP -->
        <div style="display:block; padding-top:20px; width:100%; height:110px; background:#FFF; text-align:center;" class="clearfix">
            <script async="" src="http://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
            <!-- CWB Node Leaderboard -->
            <ins class="adsbygoogle" style="display:inline-block;width:728px;height:90px; margin:0 auto;" data-ad-client="ca-pub-8948395083004413" data-ad-slot="2558964100"></ins>
            <script>
            (adsbygoogle = window.adsbygoogle || []).push({});
            </script>
        </div>

		<!-- CONTENT & SIDEBAR WRAP -->
		<div class="contentsidebarwrap clearfix">

			<!-- CONTENT -->
			<article class="content subpage web tutorial">

<h1 class="title">
    Creating a Simple RESTful Web App with Node.js, Express, and MongoDB
</h1>

<h2 class="subtitle">
    Learn the basics of REST and use them to build an easy, fast, single-page web app.
</h2>

<p class="byline">By <a href="http://cwbuecheler.com/" target="_blank">Christopher Buecheler</a></p>

<p class="center" style="color:#0C0; background:rgba(0,255,0,0.1); padding:10px; text-align:center;"><strong>Last Updated:</strong> June 7, 2015</p>

<p style="padding:15px; background:#EEE;"><a href="https://github.com/cwbuecheler/node-tutorial-2-restful-app" target="_blank">You can find/fork the sample project on GitHub</a></p>

<p>
	In <a href="http://cwbuecheler.com/web/tutorials/2013/node-express-mongo/" target="_blank">my first tutorial</a>, we looked at how to go from nothing installed, to a fully-functioning Node.js web app, using the Express framework, that reads from and writes to a MongoDB database. That's a great start, and if you're unfamiliar with those technologies, now would be an excellent time to go through the tutorial, because we're about to delve deeper. You're going to need to know how to get a webserver running with Express, and how to use app.get and app.post to communicate with both the server and the database. It's all covered in that original tutorial, and if you're a developer who's familiar with JavaScript, it's not hard. <a href="http://cwbuecheler.com/web/tutorials/2013/node-express-mongo/">Go check it out</a>!
</p>

<p>
	Back? … or rolling your eyes and going, “dude, I already know that stuff”? Either way, great! Let's add some new tools to our toolbox, and create a simple little app that works without a single page refresh. Here are the goals:
</p>

<ul>
	<li>Learn what REST means in plain English</li>
	<li>Store and retrieve JSON data in a MongoDB collection using HTTP POST and HTTP GET</li>
	<li>Remove data from the collection using HTTP DELETE</li>
	<li>Use AJAX for all data operations</li>
	<li>Update the DOM with jQuery</li>
</ul>

<p>
	Basically, in the first tutorial, we built a simple front-end app atop the Router/View back-end. In this tutorial, we're going to eliminate the need for page refreshing or visiting separate URIs entirely. It's all going to work out fine. But before we start building, let's get some REST …
</p>

<h3>Part 1 - Seriously, what the hell is REST?</h3>
<p>
	Wikipedia, that infallible source, defines Representational State Transfer (REST) as: <em>an architectural style that abstracts the architectural elements within a distributed hypermedia system</em>. Everyone got that? We clear and ready to move on?
</p>

<p>
	… not so much?
</p>

<p>
	Yeah, me either. I have no idea what a distributed hypermedia system is, and I'm OK admitting that. Let's try to put the concepts of REST in plain English. To do that, we're going to borrow four basic design principles from <a href="http://www.ibm.com/developerworks/webservices/library/ws-restful/" target="_blank">IBM's developerWorks website</a>, and explain what they mean.
</p>

<ul>
	<li>Use HTTP methods explicitly.</li>
	<li>Be stateless.</li>
	<li>Expose directory structure-like URIs.</li>
	<li>Transfer XML, JavaScript Object Notation (JSON), or both.</li>
</ul>

<p>
	<strong>Use HTTP Methods Explicitly</strong><br>
	This one's pretty straightforward. To retrieve data, you use GET. To create data, you use POST. To update or change data, you use PUT (not used in this tutorial). To delete data you use DELETE. So for example, this once-common approach is not a good one:
</p>

<p>
	<strong><font><font>http://www.domain.com/myservice/newuser.php?newuser=bob</font></font></strong>
</p>

<p>
	That's an HTTP GET pretending to be a POST. You're GETting the web page and giving it data to store in a DB at the same time. Instead, create a NewUser service and POST to it.
</p>

<p>
	<strong>Be Stateless</strong><br>
	This is a complicated concept but it boils down to “don't store state information on the server”. If you must save state, save it on the client side via cookies or other methods. A front-end framework like Angular (outside the scope of this tutorial, but stay tuned!) is particularly helpful here, as it creates an entire client-side MVC setup where you can save and manipulate the state of elements without hammering your server.
</p>

<p>
	IBM gives a pagination example which is pretty good. A stateful design would hit a deliverPage service that's been keeping track of the page you're on, and delivers the next one. a Stateless design would populate prevPage, currPage, and nextPage data in the markup (hidden input fields, JavaScript variables, data- attributes, and so on), and then HTTP GET a newPage service using the nextPage parameter from the markup to request a specific page.
</p>

<p>
	I've put together <a href="http://jsfiddle.net/cwbuecheler/7fars/" target="blank">a quick JSFiddle</a> illustrating what I'm talking about. Take a look and note that we're never storing any page data on the “server” side. We merely take the current page value from the DOM, and then when we get our new page, we update the DOM. That's simple, stateless programming.
</p>

<p>
	<strong>Expose directory structure-like URIs.</strong><br>
	This one's easy. Instead of:
</p>

<p>
	http://app.com/getfile.php?type=video&amp;game=skyrim&amp;pid=68
</p>

<p>
	You want:
</p>

<p>
	http://app.com/files/video/skyrim/68
</p>

<p>
	<strong>Transfer XML, JavaScript Object Notation (JSON), or both.</strong><br>
	This one's easy too! Just make sure that your back-end is sending XML or JSON (I prefer JSON, especially in all-JavaScript setups like the one discussed in this tutorial). You can easily manipulate this data in your presentation layer without having to hit your servers, unless you need new data.
</p>

<p>
	OK … so do we get the basics of REST? It's pretty straightforward, really. You've probably already worked within systems that use it.
</p>

<h3>Part 2 - Setup</h3>
<p>
	Now that we have an idea of what REST is all about, let's put it to work for us by building a stupidly simple single-page web app that's completely valueless. Kind of like half the startups in the Valley, amirite?! Is this thing on?
</p>

<p>
	Anyway, no, we're not building a to-do list, though that's become the “Hello World” of web apps. We're going to build a simple collection of usernames and emails, much like we did in our previous tutorial. So, let's get started. Make sure you've got the latest stable version of Node installed on your machine, then fire up a console window and navigate to wherever you're storing these web projects. For the purposes of this tutorial, that's C:\node\. If you're placing your work elsewhere (for example /home or /Users), adjust accordingly.
</p>

<p>
	The first thing we'll want to do is update Express and the Express scaffolding generator globally, like this:
</p>

<h5>Command C:\node\</h5>
<pre class="prettyprint prettyprinted"><code><span class="pln">
npm update </span><span class="pun">-</span><span class="pln">g express
</span></code>
</pre>

<p>
	Once that's done, type the following:
</p>

<h5><font><font>Command C:\node\</font></font></h5>
<pre class="prettyprint prettyprinted"><code><span class="pln">
npm update </span><span class="pun">-</span><span class="pln">g express</span><span class="pun">-</span><span class="pln">generator
</span></code>
</pre>

<p>
  Finally, follow it up with:
</p>

<h5><font><font>Command C:\node\</font></font></h5>
<pre class="prettyprint prettyprinted"><code><span class="pln"><font></font>
express nodetest2<font></font>
</span></code>
</pre>

<p>
	As you'll remember from this last tutorial, this is going to auto-generate a website skeleton in a new directory called nodetest2. Watch as it does its thing, and when it's done, open the newly created package.json file (in the newly created nodetest2 folder) in your text editor of choice, and change it so it looks like this:
</p>

<h5>C:\node\nodetest2\package.json</h5>
<pre class="prettyprint prettyprinted"><code><span class="pln">
</span><span class="pun">{</span><span class="pln">
    </span><span class="str">"name"</span><span class="pun">:</span><span class="pln"> </span><span class="str">"nodetest2b"</span><span class="pun">,</span><span class="pln">
    </span><span class="str">"version"</span><span class="pun">:</span><span class="pln"> </span><span class="str">"0.0.0"</span><span class="pun">,</span><span class="pln">
    </span><span class="str">"private"</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">true</span><span class="pun">,</span><span class="pln">
    </span><span class="str">"scripts"</span><span class="pun">:</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        </span><span class="str">"start"</span><span class="pun">:</span><span class="pln"> </span><span class="str">"node ./bin/www"</span><span class="pln">
    </span><span class="pun">},</span><span class="pln">
    </span><span class="str">"dependencies"</span><span class="pun">:</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        </span><span class="str">"body-parser"</span><span class="pun">:</span><span class="pln"> </span><span class="str">"~1.12.4"</span><span class="pun">,</span><span class="pln">
        </span><span class="str">"cookie-parser"</span><span class="pun">:</span><span class="pln"> </span><span class="str">"~1.3.5"</span><span class="pun">,</span><span class="pln">
        </span><span class="str">"debug"</span><span class="pun">:</span><span class="pln"> </span><span class="str">"~2.2.0"</span><span class="pun">,</span><span class="pln">
        </span><span class="str">"express"</span><span class="pun">:</span><span class="pln"> </span><span class="str">"~4.12.4"</span><span class="pun">,</span><span class="pln">
        </span><span class="str">"jade"</span><span class="pun">:</span><span class="pln"> </span><span class="str">"~1.9.2"</span><span class="pun">,</span><span class="pln">
        </span><span class="str">"morgan"</span><span class="pun">:</span><span class="pln"> </span><span class="str">"~1.5.3"</span><span class="pun">,</span><span class="pln">
        </span><span class="str">"serve-favicon"</span><span class="pun">:</span><span class="pln"> </span><span class="str">"~2.2.1"</span><span class="pun">,</span><span class="pln">
        </span><span class="str">"mongodb"</span><span class="pun">:</span><span class="pln"> </span><span class="str">"~2.0.33"</span><span class="pun">,</span><span class="pln">
        </span><span class="str">"monk"</span><span class="pun">:</span><span class="pln"> </span><span class="str">"~1.0.1"</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span></code>
</pre>

<p>
	As usual, these versions are up to date as of the "last update" box at the top, and are proven to work with this tutorial. Use newer versions at your own peril! Note that we're adding the MongoDB and Monk packages so that we can access and control our database.

</p><p>
    Switch back to your command prompt, <strong>cd to your nodetest2 directory</strong>, and type:
</p>

<h5>Command C:\node\nodetest2\</h5>
<pre class="prettyprint prettyprinted"><code><span class="pln"><font></font>
npm install<font></font>
</span></code>
</pre>

<p>
	Watch as all your dependencies install – it'll take a while. Very exciting! After that, there's one small thing to do. In the same command prompt, just type:
</p>

<h5><font><font>Command C:\node\nodetest2\</font></font></h5>
<pre class="prettyprint prettyprinted"><code><span class="pln"><font></font>
mkdir data<font></font>
</span></code>
</pre>

<p>
	This is where we'll store our database files when we get to that point. If you'd like to store them elsewhere, that's absolutely fine … just know that you need to have the directory ready before running MongoDB. That's it; we're going to prepopulate the database later in this tutorial, so we're done with setup for now. It's time to get started making web pages.
</p>

<p>
	One final note: this article uses four-space indentation for everything because that's fairly popular in the JavaScript community. I actually mostly work in tabs. I know this is a big debate, but honestly given how fast and easy it is to convert spaces to tabs and back again with any decent editor, I don't really see the issue. Unless your team has a standard everyone's agreed to, you should work with what you want.
</p>

<h3>Part 3 - Starting In On HTML</h3>

<p>
	If we're going to have a single-page web app, the first thing we need is a single page, right? Let's open up our views folder, and start with layout.jade. This is a template file that we're only going to make a few basic changes to. Here's how it starts:
</p>

<h5>C:\node\nodetest2\views\layout.jade</h5>
<pre class="prettyprint prettyprinted"><code><span class="pln"><font></font>
doctype html<font></font>
html<font></font>
    head<font></font>
        title</span><span class="pun">=</span><span class="pln"> title<font></font>
        link</span><span class="pun">(</span><span class="pln">rel</span><span class="pun">=</span><span class="str">'stylesheet'</span><span class="pun">,</span><span class="pln"> href</span><span class="pun">=</span><span class="str">'/stylesheets/style.css'</span><span class="pun">)</span><span class="pln"><font></font>
    body<font></font>
        block content<font></font>
</span></code>
</pre>

<p>
	We want to be able to do two things. One: include jQuery, and two: include our master javascript file. So let's edit the file and make it look like this:
</p>

<h5><font><font>C:\node\nodetest2\views\layout.jade</font></font></h5>
<pre class="prettyprint prettyprinted"><code><span class="pln"><font></font><font><font>
doctype html</font></font><font></font><font><font>
html</font></font><font></font><font><font>
    head</font></font><font></font><font><font>
        title</font></font></span><span class="pun"><font><font>=</font></font></span><span class="pln"><font><font> title</font></font><font></font><font><font>
        link</font></font></span><span class="pun"><font><font>(</font></font></span><span class="pln"><font><font>rel</font></font></span><span class="pun"><font><font>=</font></font></span><span class="str"><font><font>'stylesheet'</font></font></span><span class="pun"><font><font>,</font></font></span><span class="pln"><font><font> href</font></font></span><span class="pun"><font><font>=</font></font></span><span class="str"><font><font>'/stylesheets/style.css'</font></font></span><span class="pun"><font><font>)</font></font></span><span class="pln"><font></font><font><font>
    body</font></font><font></font><font><font>
        block content</font></font><font></font>
        script</span><span class="pun">(</span><span class="pln">src</span><span class="pun">=</span><span class="str">'http://ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js'</span><span class="pun">)</span><span class="pln">
        script</span><span class="pun">(</span><span class="pln">src</span><span class="pun">=</span><span class="str">'/javascripts/global.js'</span><span class="pun">)</span><span class="pln">
</span></code>
</pre>

<p>
	Astute readers may note that global.js does not actually exist yet. This is true. We're going to make it in a bit. For now, it'll just quietly 404 in the background when we load our index page. If this really bothers you, feel free to create an empty file now in /public/javascripts/.
</p>

<p>
	Onward to index.jade – this is the only HTML file we'll need for the rest of our webapp. We're going to put quite a lot of stuff onto this page. In the real world, we'd also need quite a lot of CSS, but for the sake of saving time, just <a href="http://cwbuecheler.com/web/tutorials/2014/restful-web-app-node-express-mongodb/style.css">download this file</a> and copy it over /public/stylesheets/style.css. It'll give you a basic layout to work with, which you can modify to be as pretty as your heart desires.
</p>

<p>
	Open index.jade. You'll see a VERY basic skeleton here:
</p>

<h5>C:\node\nodetest2\views\index.jade</h5>
<pre class="prettyprint prettyprinted"><code><span class="pln">
</span><span class="kwd">extends</span><span class="pln"> layout<font></font>
<font></font>
block content<font></font>
    h1</span><span class="pun">=</span><span class="pln"> title<font></font>
    p </span><span class="typ">Welcome</span><span class="pln"> to </span><span class="com">#{title}</span><span class="pln">
</span></code>
</pre>

<p>
	That's not very exciting. Let's get started modifying this guy. That h1= title line, and the paragraph after it, are both pulling a title variable that's set in /routes/index.js, and just says "Express". That's kind of repetetive, so let's change the paragraph to just say "Welcome to our test". Then let's add a wrapper, and add a table skeleton for displaying a list of users:
</p>

<h5><font><font>C:\node\nodetest2\views\index.jade</font></font></h5>
<pre class="prettyprint prettyprinted"><code><span class="pln">
</span><span class="kwd"><font><font>extends</font></font></span><span class="pln"><font><font> layout</font></font><font></font>
<font></font><font><font>
block content</font></font><font></font><font><font>
    h1</font></font></span><span class="pun"><font><font>=</font></font></span><span class="pln"><font><font> title</font></font><font></font>
    p </span><span class="typ">Welcome</span><span class="pln"> to </span><span class="kwd">our</span><span class="pln"> test<font></font>
<font></font>
    </span><span class="com">// Wrapper</span><span class="pln">
    </span><span class="com">#wrapper</span><span class="pln"><font></font>
<font></font>
        </span><span class="com">// USER LIST</span><span class="pln">
        h2 </span><span class="typ">User</span><span class="pln"> </span><span class="typ">List</span><span class="pln">
        </span><span class="com">#userList</span><span class="pln"><font></font>
            table<font></font>
                thead<font></font>
                    th </span><span class="typ">UserName</span><span class="pln">
                    th </span><span class="typ">Email</span><span class="pln">
                    th </span><span class="typ">Delete</span><span class="pun">?</span><span class="pln"><font></font><font><font>
                tbody</font></font><font></font>
        </span><span class="com">// /USER LIST</span><span class="pln"><font></font>
<font></font>
    </span><span class="com">// /WRAPPER</span><span class="pln">
</span></code>
</pre>

<p>
	You'll note that there's no data in the table. That's because we're going to populate it, via AJAX, with stuff we pull out of our MongoDB database. So, let's get that set up, and then we'll do a little javascripting to pull things together.
</p>

<p>
	If you want to see what the page looks like right now, go ahead and type the following into your terminal:
</p>

<h5><font><font>Command C:\node\nodetest2\</font></font></h5>
<pre class="prettyprint prettyprinted"><code><span class="pln"><font></font>
npm start<font></font>
</span></code>
</pre>

<p>
	Then navigate to <a href="http://localhost:3000/" target="_blank">http://localhost:3000</a> … you'll see a very basic, very boring page with an empty table in it. If you've downloaded the CSS file mentioned above and overwritten the default stylesheet, it will look like this:
</p>

<p class="browsershot"><img src="./Creating a Simple RESTful Web App with Node.js, Express, and MongoDB _ Christopher Buecheler - Web, Writing, Cocktails and More_files/restful_web_app_screenshot_01.png" alt="Restful Web App Screenshot 1"></p>

<p>
	Exciting, right? Not really. Let's make it do something.
</p>

<h3>Part 4 - The Database</h3>

<p>
	We already covered getting MongoDB up and running in the previous tutorial, so I'm going to skip right to the good stuff here. In a <strong>new</strong> terminal or command prompt window, navigate to wherever you keep MongoDB (for example: C:\mongo\bin) and type
</p>

<h5>Command C:\mongo\bin\</h5>
<pre class="prettyprint prettyprinted"><code><span class="pln">
mongod </span><span class="pun">--</span><span class="pln">dbpath c</span><span class="pun">:</span><span class="pln">\node\nodetest2\data
</span></code>
</pre>

<p>
	Obviously if you've decided to store your data elsewhere, you should use that path instead. You should see the MongoDB daemon fire up and report that it's waiting for connections. So let's connect: open up a <strong>new</strong> terminal/command window, navigate to your Mongo directory, and type:
</p>

<h5><font><font>Command C:\mongo\bin\</font></font></h5>
<pre class="prettyprint prettyprinted"><code><span class="pln"><font></font><font><font>
mongo</font></font><font></font>
</span></code>
</pre>

<p>
	Now we've got a command interface for our database. This, too, was discussed in the previous tutorial, so again I'm going to jump right into “just doing” instead of explaining. Let's switch to a new database (for our new project) by typing the following:
</p>

<h5>Mongo Console</h5>
<pre class="prettyprint prettyprinted"><code><span class="pln">
</span><span class="kwd">use</span><span class="pln"> nodetest2
</span></code>
</pre>

<p>
	Now we want to create and populate the “userlist” collection within our nodetest2 database. We're going to do this in one fell swoop by just inserting into the empty collection, like this:
</p>

<h5><font><font>Mongo Console</font></font></h5>
<pre class="prettyprint prettyprinted"><code><span class="pln">
db</span><span class="pun">.</span><span class="pln">userlist</span><span class="pun">.</span><span class="pln">insert</span><span class="pun">({</span><span class="str">'username'</span><span class="pln"> </span><span class="pun">:</span><span class="pln"> </span><span class="str">'test1'</span><span class="pun">,</span><span class="str">'email'</span><span class="pln"> </span><span class="pun">:</span><span class="pln"> </span><span class="str">'test1@test.com'</span><span class="pun">,</span><span class="str">'fullname'</span><span class="pln"> </span><span class="pun">:</span><span class="pln"> </span><span class="str">'Bob Smith'</span><span class="pun">,</span><span class="str">'age'</span><span class="pln"> </span><span class="pun">:</span><span class="pln"> </span><span class="lit">27</span><span class="pun">,</span><span class="str">'location'</span><span class="pln"> </span><span class="pun">:</span><span class="pln"> </span><span class="str">'San Francisco'</span><span class="pun">,</span><span class="str">'gender'</span><span class="pln"> </span><span class="pun">:</span><span class="pln"> </span><span class="str">'Male'</span><span class="pun">})</span><span class="pln">
</span></code>
</pre>

<p>
	Note: I like to type this stuff out in a text editor first, using tabs and all that, so I can see what I'm doing, before collapsing it down to a single line and pasting it into the MongoDB console. You should do whatever works best for you.
</p>

<p>
	That's all the data we need to prepopulate, this time around. We don't even <em>really</em> need to do that much, since we're going to be creating an add user routine anyway, but it makes it easier to see that yes, our DB connection is working, as we first start to wire up our app.
</p>

<p>
	You can exit out of the MongoDB console right now and kill that terminal, if you want, but make sure to leave the MongoDB daemon running. If you close it down, our website won't be able to connect to a database, and that would be a Bad Thing.
</p>

<h3>Part 5 - Listing Users</h3>

<p>
	It's time to start making changes to app.js, the heart and soul of our application. By default Express has set it up pretty well, but we'll need to add some hooks for Monk. Here's what we start with:
</p>

<h5>C:\node\nodetest2\app.js</h5>
<pre class="prettyprint prettyprinted"><span class="kwd">var</span><span class="pln"> express </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">require</span><span class="pun">(</span><span class="str">'express'</span><span class="pun">);</span><span class="pln">
</span><span class="kwd">var</span><span class="pln"> path </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">require</span><span class="pun">(</span><span class="str">'path'</span><span class="pun">);</span><span class="pln">
</span><span class="kwd">var</span><span class="pln"> favicon </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">require</span><span class="pun">(</span><span class="str">'serve-favicon'</span><span class="pun">);</span><span class="pln">
</span><span class="kwd">var</span><span class="pln"> logger </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">require</span><span class="pun">(</span><span class="str">'morgan'</span><span class="pun">);</span><span class="pln">
</span><span class="kwd">var</span><span class="pln"> cookieParser </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">require</span><span class="pun">(</span><span class="str">'cookie-parser'</span><span class="pun">);</span><span class="pln">
</span><span class="kwd">var</span><span class="pln"> bodyParser </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">require</span><span class="pun">(</span><span class="str">'body-parser'</span><span class="pun">);</span><span class="pln"><font></font>
<font></font>
</span><span class="kwd">var</span><span class="pln"> routes </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">require</span><span class="pun">(</span><span class="str">'./routes/index'</span><span class="pun">);</span><span class="pln">
</span><span class="kwd">var</span><span class="pln"> users </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">require</span><span class="pun">(</span><span class="str">'./routes/users'</span><span class="pun">);</span><span class="pln"><font></font>
<font></font>
</span><span class="kwd">var</span><span class="pln"> app </span><span class="pun">=</span><span class="pln"> express</span><span class="pun">();</span><span class="pln"><font></font>
<font></font>
</span><span class="com">// view engine setup</span><span class="pln">
app</span><span class="pun">.</span><span class="kwd">set</span><span class="pun">(</span><span class="str">'views'</span><span class="pun">,</span><span class="pln"> path</span><span class="pun">.</span><span class="pln">join</span><span class="pun">(</span><span class="pln">__dirname</span><span class="pun">,</span><span class="pln"> </span><span class="str">'views'</span><span class="pun">));</span><span class="pln">
app</span><span class="pun">.</span><span class="kwd">set</span><span class="pun">(</span><span class="str">'view engine'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'jade'</span><span class="pun">);</span><span class="pln"><font></font>
<font></font>
</span><span class="com">// uncomment after placing your favicon in /public</span><span class="pln">
</span><span class="com">//app.use(favicon(__dirname + '/public/favicon.ico'));</span><span class="pln">
app</span><span class="pun">.</span><span class="kwd">use</span><span class="pun">(</span><span class="pln">logger</span><span class="pun">(</span><span class="str">'dev'</span><span class="pun">));</span><span class="pln">
app</span><span class="pun">.</span><span class="kwd">use</span><span class="pun">(</span><span class="pln">bodyParser</span><span class="pun">.</span><span class="pln">json</span><span class="pun">());</span><span class="pln">
app</span><span class="pun">.</span><span class="kwd">use</span><span class="pun">(</span><span class="pln">bodyParser</span><span class="pun">.</span><span class="pln">urlencoded</span><span class="pun">());</span><span class="pln">
app</span><span class="pun">.</span><span class="kwd">use</span><span class="pun">(</span><span class="pln">cookieParser</span><span class="pun">());</span><span class="pln">
app</span><span class="pun">.</span><span class="kwd">use</span><span class="pun">(</span><span class="pln">express</span><span class="pun">.</span><span class="kwd">static</span><span class="pun">(</span><span class="pln">path</span><span class="pun">.</span><span class="pln">join</span><span class="pun">(</span><span class="pln">__dirname</span><span class="pun">,</span><span class="pln"> </span><span class="str">'public'</span><span class="pun">)));</span><span class="pln"><font></font>
<font></font>
app</span><span class="pun">.</span><span class="kwd">use</span><span class="pun">(</span><span class="str">'/'</span><span class="pun">,</span><span class="pln"> routes</span><span class="pun">);</span><span class="pln">
app</span><span class="pun">.</span><span class="kwd">use</span><span class="pun">(</span><span class="str">'/users'</span><span class="pun">,</span><span class="pln"> users</span><span class="pun">);</span><span class="pln"><font></font>
<font></font>
</span><span class="com">/// catch 404 and forwarding to error handler</span><span class="pln">
app</span><span class="pun">.</span><span class="kwd">use</span><span class="pun">(</span><span class="kwd">function</span><span class="pun">(</span><span class="pln">req</span><span class="pun">,</span><span class="pln"> res</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">next</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">var</span><span class="pln"> err </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Error</span><span class="pun">(</span><span class="str">'Not Found'</span><span class="pun">);</span><span class="pln">
    err</span><span class="pun">.</span><span class="pln">status </span><span class="pun">=</span><span class="pln"> </span><span class="lit">404</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">next</span><span class="pun">(</span><span class="pln">err</span><span class="pun">);</span><span class="pln">
</span><span class="pun">});</span><span class="pln"><font></font>
<font></font>
</span><span class="com">/// error handlers</span><span class="pln"><font></font>
<font></font>
</span><span class="com">// development error handler</span><span class="pln">
</span><span class="com">// will print stacktrace</span><span class="pln">
</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">app</span><span class="pun">.</span><span class="kwd">get</span><span class="pun">(</span><span class="str">'env'</span><span class="pun">)</span><span class="pln"> </span><span class="pun">===</span><span class="pln"> </span><span class="str">'development'</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    app</span><span class="pun">.</span><span class="kwd">use</span><span class="pun">(</span><span class="kwd">function</span><span class="pun">(</span><span class="pln">err</span><span class="pun">,</span><span class="pln"> req</span><span class="pun">,</span><span class="pln"> res</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">next</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        res</span><span class="pun">.</span><span class="pln">status</span><span class="pun">(</span><span class="pln">err</span><span class="pun">.</span><span class="pln">status </span><span class="pun">||</span><span class="pln"> </span><span class="lit">500</span><span class="pun">);</span><span class="pln">
        res</span><span class="pun">.</span><span class="pln">render</span><span class="pun">(</span><span class="str">'error'</span><span class="pun">,</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            message</span><span class="pun">:</span><span class="pln"> err</span><span class="pun">.</span><span class="pln">message</span><span class="pun">,</span><span class="pln">
            error</span><span class="pun">:</span><span class="pln"> err
        </span><span class="pun">});</span><span class="pln">
    </span><span class="pun">});</span><span class="pln">
</span><span class="pun">}</span><span class="pln"><font></font>
<font></font>
</span><span class="com">// production error handler</span><span class="pln">
</span><span class="com">// no stacktraces leaked to user</span><span class="pln">
app</span><span class="pun">.</span><span class="kwd">use</span><span class="pun">(</span><span class="kwd">function</span><span class="pun">(</span><span class="pln">err</span><span class="pun">,</span><span class="pln"> req</span><span class="pun">,</span><span class="pln"> res</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">next</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    res</span><span class="pun">.</span><span class="pln">status</span><span class="pun">(</span><span class="pln">err</span><span class="pun">.</span><span class="pln">status </span><span class="pun">||</span><span class="pln"> </span><span class="lit">500</span><span class="pun">);</span><span class="pln">
    res</span><span class="pun">.</span><span class="pln">render</span><span class="pun">(</span><span class="str">'error'</span><span class="pun">,</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        message</span><span class="pun">:</span><span class="pln"> err</span><span class="pun">.</span><span class="pln">message</span><span class="pun">,</span><span class="pln">
        error</span><span class="pun">:</span><span class="pln"> </span><span class="pun">{}</span><span class="pln">
    </span><span class="pun">});</span><span class="pln">
</span><span class="pun">});</span><span class="pln"><font></font>
<font></font>
<font></font>
</span><span class="kwd">module</span><span class="pun">.</span><span class="pln">exports </span><span class="pun">=</span><span class="pln"> app</span><span class="pun">;</span><span class="pln">
</span></pre>

<p>
	We're going to add a few things to the section at the very top, so that it looks like this:
</p>

<h5><font><font>C:\node\nodetest2\app.js</font></font></h5>
<pre class="prettyprint prettyprinted"><code><span class="pln">
</span><span class="kwd">var</span><span class="pln"> express </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">require</span><span class="pun">(</span><span class="str">'express'</span><span class="pun">);</span><span class="pln">
</span><span class="kwd">var</span><span class="pln"> path </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">require</span><span class="pun">(</span><span class="str">'path'</span><span class="pun">);</span><span class="pln">
</span><span class="kwd">var</span><span class="pln"> favicon </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">require</span><span class="pun">(</span><span class="str">'serve-favicon'</span><span class="pun">);</span><span class="pln">
</span><span class="kwd">var</span><span class="pln"> logger </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">require</span><span class="pun">(</span><span class="str">'morgan'</span><span class="pun">);</span><span class="pln">
</span><span class="kwd">var</span><span class="pln"> cookieParser </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">require</span><span class="pun">(</span><span class="str">'cookie-parser'</span><span class="pun">);</span><span class="pln">
</span><span class="kwd">var</span><span class="pln"> bodyParser </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">require</span><span class="pun">(</span><span class="str">'body-parser'</span><span class="pun">);</span><span class="pln">
</span><span class="com">// Database</span><span class="pln">
</span><span class="kwd">var</span><span class="pln"> mongo </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">require</span><span class="pun">(</span><span class="str">'mongodb'</span><span class="pun">);</span><span class="pln">
</span><span class="kwd">var</span><span class="pln"> monk </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">require</span><span class="pun">(</span><span class="str">'monk'</span><span class="pun">);</span><span class="pln">
</span><span class="kwd">var</span><span class="pln"> db </span><span class="pun">=</span><span class="pln"> monk</span><span class="pun">(</span><span class="str">'localhost:27017/nodetest2'</span><span class="pun">);</span><span class="pln">
</span></code>
</pre>

<p>
	Here we're calling the Monk module and then giving it some basic configuration parameters (including telling it where the DB lives, and which database to use – nodetest2).
</p>

<p>
	We also need to make our database accessible to our various http requests, as we did in the first tutorial. To do that, first find this section:
</p>

<h5><font><font>C:\node\nodetest2\app.js</font></font></h5>
<pre class="prettyprint prettyprinted"><code><span class="pln"><font><font>
app</font></font></span><span class="pun"><font><font>.</font></font></span><span class="kwd"><font><font>use</font></font></span><span class="pun"><font><font>(</font></font></span><span class="str"><font><font>'/'</font></font></span><span class="pun"><font><font>,</font></font></span><span class="pln"><font><font> routes</font></font></span><span class="pun"><font><font>);</font></font></span><span class="pln"><font><font>
app</font></font></span><span class="pun"><font><font>.</font></font></span><span class="kwd"><font><font>use</font></font></span><span class="pun"><font><font>(</font></font></span><span class="str"><font><font>'/users'</font></font></span><span class="pun"><font><font>,</font></font></span><span class="pln"><font><font> users</font></font></span><span class="pun"><font><font>);</font></font></span><span class="pln">
</span></code>
</pre>

<p>
	And just <strong>above it</strong>, add this code:
</p>

<h5><font><font>C:\node\nodetest2\app.js</font></font></h5>
<pre class="prettyprint prettyprinted"><code><span class="pln">
</span><span class="com">// Make our db accessible to our router</span><span class="pln">
app</span><span class="pun">.</span><span class="kwd">use</span><span class="pun">(</span><span class="kwd">function</span><span class="pun">(</span><span class="pln">req</span><span class="pun">,</span><span class="pln">res</span><span class="pun">,</span><span class="kwd">next</span><span class="pun">){</span><span class="pln">
    req</span><span class="pun">.</span><span class="pln">db </span><span class="pun">=</span><span class="pln"> db</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">next</span><span class="pun">();</span><span class="pln">
</span><span class="pun">});</span><span class="pln">
</span></code>
</pre>

<p>
	Now it's time to move on to routing. Note that Express auto-creates a /users route file. We're going to make use of that, but we won't be creating any views for it. Why? Well, because since this is a single-page app, we're using the Index route and view for display purposes. We're going to use the user route to set up our data I/O … the services we want to create to show, add, and delete users from our database. We'll access these with JavaScript, rather than navigating to them in a browser, and display the collected data on the index page.
</p>

<p>
	So to that end, let's do a little cleanup. Open up /nodetest2/routes/users.js in your text editor. It'll look like this:
</p>

<h5>C:\node\nodetest2\routes\users.js</h5>
<pre class="prettyprint prettyprinted"><code><span class="pln">
</span><span class="kwd">var</span><span class="pln"> express </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">require</span><span class="pun">(</span><span class="str">'express'</span><span class="pun">);</span><span class="pln">
</span><span class="kwd">var</span><span class="pln"> router </span><span class="pun">=</span><span class="pln"> express</span><span class="pun">.</span><span class="typ">Router</span><span class="pun">();</span><span class="pln"><font></font>
<font></font>
</span><span class="com">/* GET users listing. */</span><span class="pln">
router</span><span class="pun">.</span><span class="kwd">get</span><span class="pun">(</span><span class="str">'/'</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">(</span><span class="pln">req</span><span class="pun">,</span><span class="pln"> res</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
  res</span><span class="pun">.</span><span class="pln">send</span><span class="pun">(</span><span class="str">'respond with a resource'</span><span class="pun">);</span><span class="pln">
</span><span class="pun">});</span><span class="pln"><font></font>
<font></font>
</span><span class="kwd">module</span><span class="pun">.</span><span class="pln">exports </span><span class="pun">=</span><span class="pln"> router</span><span class="pun">;</span><span class="pln">
</span></code>
</pre>

<p>
	Go ahead and <strong>delete the comment and the three lines below it</strong>. We're going to replace it with our own code, for /users/userlist. So our file's going to look like this:
</p>

<h5><font><font>C:\node\nodetest2\routes\users.js</font></font></h5>
<pre class="prettyprint prettyprinted"><code><span class="pln">
</span><span class="kwd"><font><font>var</font></font></span><span class="pln"><font><font> express </font></font></span><span class="pun"><font><font>=</font></font></span><span class="pln"> </span><span class="kwd"><font><font>require</font></font></span><span class="pun"><font><font>(</font></font></span><span class="str"><font><font>'express'</font></font></span><span class="pun"><font><font>);</font></font></span><span class="pln">
</span><span class="kwd"><font><font>var</font></font></span><span class="pln"><font><font> router </font></font></span><span class="pun"><font><font>=</font></font></span><span class="pln"><font><font> express</font></font></span><span class="pun"><font><font>.</font></font></span><span class="typ"><font><font>Router</font></font></span><span class="pun"><font><font>();</font></font></span><span class="pln"><font></font>
<font></font>
</span><span class="com">/*<font></font>
 * GET userlist.<font></font>
 */</span><span class="pln">
router</span><span class="pun">.</span><span class="kwd">get</span><span class="pun">(</span><span class="str">'/userlist'</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">(</span><span class="pln">req</span><span class="pun">,</span><span class="pln"> res</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">var</span><span class="pln"> db </span><span class="pun">=</span><span class="pln"> req</span><span class="pun">.</span><span class="pln">db</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">var</span><span class="pln"> collection </span><span class="pun">=</span><span class="pln"> db</span><span class="pun">.</span><span class="kwd">get</span><span class="pun">(</span><span class="str">'userlist'</span><span class="pun">);</span><span class="pln">
    collection</span><span class="pun">.</span><span class="pln">find</span><span class="pun">({},{},</span><span class="kwd">function</span><span class="pun">(</span><span class="pln">e</span><span class="pun">,</span><span class="pln">docs</span><span class="pun">){</span><span class="pln">
        res</span><span class="pun">.</span><span class="pln">json</span><span class="pun">(</span><span class="pln">docs</span><span class="pun">);</span><span class="pln">
    </span><span class="pun">});</span><span class="pln">
</span><span class="pun">});</span><span class="pln"><font></font>
<font></font>
</span><span class="kwd"><font><font>module</font></font></span><span class="pun"><font><font>.</font></font></span><span class="pln"><font><font>exports </font></font></span><span class="pun"><font><font>=</font></font></span><span class="pln"><font><font> router</font></font></span><span class="pun"><font><font>;</font></font></span><span class="pln">
</span></code>
</pre>

<p>
	The purpose of this code is: if you do an HTTP GET to /users/userlist, our server will return JSON that lists all of the users in the database. Obviously for a large-scale project you'd want to put in limits as to how much data gets spewed out at one time, for example by adding paging to your front-end, but for our purposes this is fine.
</p>

<p>
	Save your users.js file, kill your node instance if it's still running, and restart it with
</p>

<h5><font><font>Command C:\node\nodetest2\</font></font></h5>
<pre class="prettyprint prettyprinted"><code><span class="pln"><font></font><font><font>
npm start</font></font><font></font>
</span></code>
</pre>

<p>
	In your terminal. Then refresh your browser. You'll see … nothing. Well, not nothing, but rather the exact same thing as you saw in your screenshot above. That's because we haven't wired anything up yet. If you want, you can navigate to <strong><a href="http://localhost:3000/users/userlist" target="_blank">http://localhost:3000/users/userlist</a></strong> where you will find the JSON output that we'll be manipulating next. It's just a single user, the one that we manually entered in the MongoDB console earlier.
</p>

<p>
	Let's get Bob Smith into our HTML, shall we? We're going to create our global.js file now, so create a new text document and save it as /nodetest2/public/javascripts/global.js
</p>

<p>
	A few notes on my coding style: I like braces and use them always, even for single-line if statements and the like. I like variable names that mean something, rather than trying to be short. I favor single quotes above double quotes. I prefer comments above lines, as opposed to on the right-hand side. I use a LOT of comments, because JS can always be minified so there's really no reason to worry about comments contributing to filesize. I use a decent amount of whitespace for the same reason. Oh, and I like my opening braces on the same line, not a new line.
</p>

<p>
	You probably hate one or more things about my style. That's fine. Adapt as you see fit. What matters is that your code is readable (if you're working with others) and that it runs (no matter what).
</p>

<p>
	Let's start by defining a function to populates our HTML table with data. I like to label the different sections of my JavaScript with big, hideous, highly-noticeable labels, so here's what we're going to do:
</p>

<h5>C:\node\nodetest2\public\javascripts\global.js</h5>
<pre class="prettyprint prettyprinted"><code><span class="pln">
</span><span class="com">// Userlist data array for filling in info box</span><span class="pln">
</span><span class="kwd">var</span><span class="pln"> userListData </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[];</span><span class="pln"><font></font>
<font></font>
</span><span class="com">// DOM Ready =============================================================</span><span class="pln">
$</span><span class="pun">(</span><span class="pln">document</span><span class="pun">).</span><span class="pln">ready</span><span class="pun">(</span><span class="kwd">function</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><font></font>
<font></font>
    </span><span class="com">// Populate the user table on initial page load</span><span class="pln">
    populateTable</span><span class="pun">();</span><span class="pln"><font></font>
<font></font>
</span><span class="pun"><font><font>});</font></font></span><span class="pln"><font></font>
<font></font>
</span><span class="com">// Functions =============================================================</span><span class="pln"><font></font>
<font></font>
</span><span class="com">// Fill table with data</span><span class="pln">
</span><span class="kwd">function</span><span class="pln"> populateTable</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><font></font>
<font></font>
    </span><span class="com">// Empty content string</span><span class="pln">
    </span><span class="kwd">var</span><span class="pln"> tableContent </span><span class="pun">=</span><span class="pln"> </span><span class="str">''</span><span class="pun">;</span><span class="pln"><font></font>
<font></font>
    </span><span class="com">// jQuery AJAX call for JSON</span><span class="pln">
    $</span><span class="pun">.</span><span class="pln">getJSON</span><span class="pun">(</span><span class="pln"> </span><span class="str">'/users/userlist'</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">(</span><span class="pln"> data </span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><font></font>
<font></font>
        </span><span class="com">// For each item in our JSON, add a table row and cells to the content string</span><span class="pln">
        $</span><span class="pun">.</span><span class="pln">each</span><span class="pun">(</span><span class="pln">data</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">(){</span><span class="pln">
            tableContent </span><span class="pun">+=</span><span class="pln"> </span><span class="str">'&lt;tr&gt;'</span><span class="pun">;</span><span class="pln">
            tableContent </span><span class="pun">+=</span><span class="pln"> </span><span class="str">'&lt;td&gt;&lt;a href="#" class="linkshowuser" rel="'</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">username </span><span class="pun">+</span><span class="pln"> </span><span class="str">'"&gt;'</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">username </span><span class="pun">+</span><span class="pln"> </span><span class="str">'&lt;/a&gt;&lt;/td&gt;'</span><span class="pun">;</span><span class="pln">
            tableContent </span><span class="pun">+=</span><span class="pln"> </span><span class="str">'&lt;td&gt;'</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">email </span><span class="pun">+</span><span class="pln"> </span><span class="str">'&lt;/td&gt;'</span><span class="pun">;</span><span class="pln">
            tableContent </span><span class="pun">+=</span><span class="pln"> </span><span class="str">'&lt;td&gt;&lt;a href="#" class="linkdeleteuser" rel="'</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">_id </span><span class="pun">+</span><span class="pln"> </span><span class="str">'"&gt;delete&lt;/a&gt;&lt;/td&gt;'</span><span class="pun">;</span><span class="pln">
            tableContent </span><span class="pun">+=</span><span class="pln"> </span><span class="str">'&lt;/tr&gt;'</span><span class="pun">;</span><span class="pln">
        </span><span class="pun">});</span><span class="pln"><font></font>
<font></font>
        </span><span class="com">// Inject the whole content string into our existing HTML table</span><span class="pln">
        $</span><span class="pun">(</span><span class="str">'#userList table tbody'</span><span class="pun">).</span><span class="pln">html</span><span class="pun">(</span><span class="pln">tableContent</span><span class="pun">);</span><span class="pln">
    </span><span class="pun">});</span><span class="pln">
</span><span class="pun">};</span><span class="pln">
</span></code>
</pre>

<p>
	As you can see, we're using a global variable and defining our functions at the top level. This is actually not a great idea and I'm only doing it for speed and simplicity. In a real app, you want to define a single master global, which you can then populate with properties, methods, etc … as needed, thus helping to avoid conflicts or generally pollute the namespace. If you want to learn more about this strategy, I strongly recommend picking up a copy of <a href="http://www.amazon.com/JavaScript-Good-Parts-Douglas-Crockford/dp/0596517742" target="_blank">JavaScript: The Good Parts</a> by Douglas Crockford and reading through it. Actually, I strongly recommend that anyway. It's an important book.
</p>

<p>
	For now, however, we'll stick with our specific global and move on to the DOM ready detect, which will fire off our table-filling method <em>populateTable()</em> when the page is ready for scripts to run. After that, we must of course define our table-filling method. That's where things get interesting, but not too terribly complex. We make a simple AJAX call via jQuery, iterate over the return JSON to create a big ol' content string with all our new HTML in it, and then inject that HTML into our existing table.
</p>

<p>
	With that JavaScript added, we can now go to our browser again and refresh or navigate to <a href="http://localhost:3000/" target="_blank">http://localhost:3000/</a> … if all is working properly, and it should be, we'll see that our table is now populated with data. Awesome!
</p>

<p class="browsershot"><img src="./Creating a Simple RESTful Web App with Node.js, Express, and MongoDB _ Christopher Buecheler - Web, Writing, Cocktails and More_files/restful_web_app_screenshot_02.png" alt="Restful Web App Screenshot 2"></p>

<p>
	That's a solid start, but it's not displaying everything we have in our database. Let's set up an info box that will display the full set of user information when we click on the username.
</p>

<h3>Part 6 - Populating User Info</h3>

<p>
	Still working in global.js, we need to add one quick line to our populateTable() function. This line will stick <em>all</em> of our user data into the array we established earlier. Again: I don't recommend taking this route if you're dealing with thousands of users. It's not a performance-friendly approach. But for quick-n-dirty, it'll work fine.
</p>

<p>
	Find this line:
</p>

<h5><font><font>C:\node\nodetest2\public\javascripts\global.js</font></font></h5>
<pre class="prettyprint prettyprinted"><code><span class="pln">
    </span><span class="com"><font><font>// jQuery AJAX call for JSON</font></font></span><span class="pln"><font><font>
    $</font></font></span><span class="pun"><font><font>.</font></font></span><span class="pln"><font><font>getJSON</font></font></span><span class="pun"><font><font>(</font></font></span><span class="pln"> </span><span class="str"><font><font>'/users/userlist'</font></font></span><span class="pun"><font><font>,</font></font></span><span class="pln"> </span><span class="kwd"><font><font>function</font></font></span><span class="pun"><font><font>(</font></font></span><span class="pln"><font><font> data </font></font></span><span class="pun"><font><font>)</font></font></span><span class="pln"> </span><span class="pun"><font><font>{</font></font></span><span class="pln">
</span></code>
</pre>

<p>
	And directly below it you'll see:
</p>

<h5><font><font>C:\node\nodetest2\public\javascripts\global.js</font></font></h5>
<pre class="prettyprint prettyprinted"><code><span class="pln">
    </span><span class="com">// For each item in our JSON, add a table row and cells to the çontent string</span><span class="pln">
    $</span><span class="pun">.</span><span class="pln">each</span><span class="pun">(</span><span class="pln">data</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">(){</span><span class="pln">
</span></code>
</pre>

<p>
	<strong>In between</strong> those lines, add the following:
</p>

<h5><font><font>C:\node\nodetest2\public\javascripts\global.js</font></font></h5>
<pre class="prettyprint prettyprinted"><code><span class="pln">
    </span><span class="com">// Stick our user data array into a userlist variable in the global object</span><span class="pln">
    userListData </span><span class="pun">=</span><span class="pln"> data</span><span class="pun">;</span><span class="pln">
</span></code>
</pre>

<p>
	What this is doing is sticking all of our returned user data, from the database, into our global variable, so that we can access it without repeatedly whaling on the database each time we click a name in our table. I want to be clear here: for large-scale operations, this is <strong>not a great idea</strong>. You would not want to do this if you were loading tens of thousands of users at once (but you probably wouldn't want to load tens of thousands of users at once, either). You'd want to implement paging, and only load the data you really needed at any given time.
</p>

<p>
	But for the purposes of this tutorial, it's fine. So head down to the end of the file, where we're keeping our functions, and add this code on a new line at the bottom:
</p>

<h5><font><font>C:\node\nodetest2\public\javascripts\global.js</font></font></h5>
<pre class="prettyprint prettyprinted"><code><span class="pln">
</span><span class="com">// Show User Info</span><span class="pln">
</span><span class="kwd">function</span><span class="pln"> showUserInfo</span><span class="pun">(</span><span class="kwd">event</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><font></font>
<font></font>
    </span><span class="com">// Prevent Link from Firing</span><span class="pln">
    </span><span class="kwd">event</span><span class="pun">.</span><span class="pln">preventDefault</span><span class="pun">();</span><span class="pln"><font></font>
<font></font>
    </span><span class="com">// Retrieve username from link rel attribute</span><span class="pln">
    </span><span class="kwd">var</span><span class="pln"> thisUserName </span><span class="pun">=</span><span class="pln"> $</span><span class="pun">(</span><span class="kwd">this</span><span class="pun">).</span><span class="pln">attr</span><span class="pun">(</span><span class="str">'rel'</span><span class="pun">);</span><span class="pln"><font></font>
<font></font>
    </span><span class="com">// Get Index of object based on id value</span><span class="pln">
    </span><span class="kwd">var</span><span class="pln"> arrayPosition </span><span class="pun">=</span><span class="pln"> userListData</span><span class="pun">.</span><span class="pln">map</span><span class="pun">(</span><span class="kwd">function</span><span class="pun">(</span><span class="pln">arrayItem</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> arrayItem</span><span class="pun">.</span><span class="pln">username</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}).</span><span class="pln">indexOf</span><span class="pun">(</span><span class="pln">thisUserName</span><span class="pun">);</span><span class="pln">
</span></code>
</pre>

<p>
	OK, that's kinda some crazy stuff. Here's what we're doing: first we're using .map to apply a function to each object in our userListData array. This will spit out a <strong>brand new array</strong> containing only whatever the function returns. That function (the anonymous callback function using the userObj parameter) strictly returns the username. So, basically, if our original data array contained two complete user objects, then the array returned by our use of .map here would only contain usernames, and look like this: ['Bob', 'Sue'].
</p>

<p>
	So once we have THAT array, provided by .map, we're chaining indexOf, in combination with the username of our choice, to get the array index of that username. So Bob would be zero, and Sue would be one. We can then use that number, stored as arrayPosition, to go back to our original user data array and start pulling data, in the following code.
</p>

<p>
	If you want to see a version of this code that DOESN'T use chaining and is a bit more verbose, <a href="http://jsfiddle.net/cwbuecheler/2qEZ2/" target="_blank">check it out at this jsfiddle</a>. In the meantime, still in that showUserInfo function, add the rest:
</p>

<h5><font><font>C:\node\nodetest2\public\javascripts\global.js</font></font></h5>
<pre class="prettyprint prettyprinted"><code><span class="pln">
    </span><span class="com">// Get our User Object</span><span class="pln">
    </span><span class="kwd">var</span><span class="pln"> thisUserObject </span><span class="pun">=</span><span class="pln"> userListData</span><span class="pun">[</span><span class="pln">arrayPosition</span><span class="pun">];</span><span class="pln"><font></font>
<font></font>
    </span><span class="com">//Populate Info Box</span><span class="pln">
    $</span><span class="pun">(</span><span class="str">'#userInfoName'</span><span class="pun">).</span><span class="pln">text</span><span class="pun">(</span><span class="pln">thisUserObject</span><span class="pun">.</span><span class="pln">fullname</span><span class="pun">);</span><span class="pln">
    $</span><span class="pun">(</span><span class="str">'#userInfoAge'</span><span class="pun">).</span><span class="pln">text</span><span class="pun">(</span><span class="pln">thisUserObject</span><span class="pun">.</span><span class="pln">age</span><span class="pun">);</span><span class="pln">
    $</span><span class="pun">(</span><span class="str">'#userInfoGender'</span><span class="pun">).</span><span class="pln">text</span><span class="pun">(</span><span class="pln">thisUserObject</span><span class="pun">.</span><span class="pln">gender</span><span class="pun">);</span><span class="pln">
    $</span><span class="pun">(</span><span class="str">'#userInfoLocation'</span><span class="pun">).</span><span class="pln">text</span><span class="pun">(</span><span class="pln">thisUserObject</span><span class="pun">.</span><span class="pln">location</span><span class="pun">);</span><span class="pln"><font></font>
<font></font>
</span><span class="pun"><font><font>};</font></font></span><span class="pln">
</span></code>
</pre>

<p>
	The function in its entirety will look like this:
</p>

<pre class="prettyprint prettyprinted"><code><span class="pln">
</span><span class="com"><font><font>// Show User Info</font></font></span><span class="pln">
</span><span class="kwd"><font><font>function</font></font></span><span class="pln"><font><font> showUserInfo</font></font></span><span class="pun"><font><font>(</font></font></span><span class="kwd"><font><font>event</font></font></span><span class="pun"><font><font>)</font></font></span><span class="pln"> </span><span class="pun"><font><font>{</font></font></span><span class="pln"><font></font>
<font></font>
    </span><span class="com"><font><font>// Prevent Link from Firing</font></font></span><span class="pln">
    </span><span class="kwd"><font><font>event</font></font></span><span class="pun"><font><font>.</font></font></span><span class="pln"><font><font>preventDefault</font></font></span><span class="pun"><font><font>();</font></font></span><span class="pln"><font></font>
<font></font>
    </span><span class="com"><font><font>// Retrieve username from link rel attribute</font></font></span><span class="pln">
    </span><span class="kwd"><font><font>var</font></font></span><span class="pln"><font><font> thisUserName </font></font></span><span class="pun"><font><font>=</font></font></span><span class="pln"><font><font> $</font></font></span><span class="pun"><font><font>(</font></font></span><span class="kwd"><font><font>this</font></font></span><span class="pun"><font><font>).</font></font></span><span class="pln"><font><font>attr</font></font></span><span class="pun"><font><font>(</font></font></span><span class="str"><font><font>'rel'</font></font></span><span class="pun"><font><font>);</font></font></span><span class="pln"><font></font>
<font></font>
    </span><span class="com"><font><font>// Get Index of object based on id value</font></font></span><span class="pln">
    </span><span class="kwd"><font><font>var</font></font></span><span class="pln"><font><font> arrayPosition </font></font></span><span class="pun"><font><font>=</font></font></span><span class="pln"><font><font> userListData</font></font></span><span class="pun"><font><font>.</font></font></span><span class="pln"><font><font>map</font></font></span><span class="pun"><font><font>(</font></font></span><span class="kwd"><font><font>function</font></font></span><span class="pun"><font><font>(</font></font></span><span class="pln"><font><font>arrayItem</font></font></span><span class="pun"><font><font>)</font></font></span><span class="pln"> </span><span class="pun"><font><font>{</font></font></span><span class="pln"> </span><span class="kwd"><font><font>return</font></font></span><span class="pln"><font><font> arrayItem</font></font></span><span class="pun"><font><font>.</font></font></span><span class="pln"><font><font>username</font></font></span><span class="pun"><font><font>;</font></font></span><span class="pln"> </span><span class="pun"><font><font>}).</font></font></span><span class="pln"><font><font>indexOf</font></font></span><span class="pun"><font><font>(</font></font></span><span class="pln"><font><font>thisUserName</font></font></span><span class="pun"><font><font>);</font></font></span><span class="pln"><font></font>
<font></font>
    </span><span class="com"><font><font>// Get our User Object</font></font></span><span class="pln">
    </span><span class="kwd"><font><font>var</font></font></span><span class="pln"><font><font> thisUserObject </font></font></span><span class="pun"><font><font>=</font></font></span><span class="pln"><font><font> userListData</font></font></span><span class="pun"><font><font>[</font></font></span><span class="pln"><font><font>arrayPosition</font></font></span><span class="pun"><font><font>];</font></font></span><span class="pln"><font></font>
<font></font>
    </span><span class="com"><font><font>//Populate Info Box</font></font></span><span class="pln"><font><font>
    $</font></font></span><span class="pun"><font><font>(</font></font></span><span class="str"><font><font>'#userInfoName'</font></font></span><span class="pun"><font><font>).</font></font></span><span class="pln"><font><font>text</font></font></span><span class="pun"><font><font>(</font></font></span><span class="pln"><font><font>thisUserObject</font></font></span><span class="pun"><font><font>.</font></font></span><span class="pln"><font><font>fullname</font></font></span><span class="pun"><font><font>);</font></font></span><span class="pln"><font><font>
    $</font></font></span><span class="pun"><font><font>(</font></font></span><span class="str"><font><font>'#userInfoAge'</font></font></span><span class="pun"><font><font>).</font></font></span><span class="pln"><font><font>text</font></font></span><span class="pun"><font><font>(</font></font></span><span class="pln"><font><font>thisUserObject</font></font></span><span class="pun"><font><font>.</font></font></span><span class="pln"><font><font>age</font></font></span><span class="pun"><font><font>);</font></font></span><span class="pln"><font><font>
    $</font></font></span><span class="pun"><font><font>(</font></font></span><span class="str"><font><font>'#userInfoGender'</font></font></span><span class="pun"><font><font>).</font></font></span><span class="pln"><font><font>text</font></font></span><span class="pun"><font><font>(</font></font></span><span class="pln"><font><font>thisUserObject</font></font></span><span class="pun"><font><font>.</font></font></span><span class="pln"><font><font>gender</font></font></span><span class="pun"><font><font>);</font></font></span><span class="pln"><font><font>
    $</font></font></span><span class="pun"><font><font>(</font></font></span><span class="str"><font><font>'#userInfoLocation'</font></font></span><span class="pun"><font><font>).</font></font></span><span class="pln"><font><font>text</font></font></span><span class="pun"><font><font>(</font></font></span><span class="pln"><font><font>thisUserObject</font></font></span><span class="pun"><font><font>.</font></font></span><span class="pln"><font><font>location</font></font></span><span class="pun"><font><font>);</font></font></span><span class="pln"><font></font>
<font></font>
</span><span class="pun"><font><font>};</font></font></span><span class="pln">
</span></code>
</pre>

<p>
	Now we need to trigger that function on a click, so back up in our DOM ready section, below the initial call to populate the table, add this code:
</p>

<pre class="prettyprint prettyprinted"><code><span class="pln">
    </span><span class="com">// Username link click</span><span class="pln">
    $</span><span class="pun">(</span><span class="str">'#userList table tbody'</span><span class="pun">).</span><span class="pln">on</span><span class="pun">(</span><span class="str">'click'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'td a.linkshowuser'</span><span class="pun">,</span><span class="pln"> showUserInfo</span><span class="pun">);</span><span class="pln">
</span></code>
</pre>

<p>
	This is all pretty straightforward. We've found our user object and we're populating spans with data. The thing is … those spans don't exist yet! Let's <strong>save global.js</strong> and then open up /views/index.jade. We want to add the following code right after the #wrapper line (and above our user list table):
</p>

<h5><font><font>C:\node\nodetest2\views\index.jade</font></font></h5>
<pre class="prettyprint prettyprinted"><code><span class="pln">
        </span><span class="com">// USER INFO</span><span class="pln">
        </span><span class="com">#userInfo</span><span class="pln">
            h2 </span><span class="typ">User</span><span class="pln"> </span><span class="typ">Info</span><span class="pln"><font></font>
            p<font></font>
                strong </span><span class="typ">Name</span><span class="pun">:</span><span class="pln">
                </span><span class="pun">|</span><span class="pln">  </span><span class="pun">&lt;</span><span class="pln">span id</span><span class="pun">=</span><span class="str">'userInfoName'</span><span class="pun">&gt;&lt;/</span><span class="pln">span</span><span class="pun">&gt;</span><span class="pln"><font></font>
                br<font></font>
                strong </span><span class="typ">Age</span><span class="pun">:</span><span class="pln">
                </span><span class="pun">|</span><span class="pln">  </span><span class="pun">&lt;</span><span class="pln">span id</span><span class="pun">=</span><span class="str">'userInfoAge'</span><span class="pun">&gt;&lt;/</span><span class="pln">span</span><span class="pun">&gt;</span><span class="pln"><font></font><font><font>
                br</font></font><font></font>
                strong </span><span class="typ">Gender</span><span class="pun">:</span><span class="pln">
                </span><span class="pun">|</span><span class="pln">  </span><span class="pun">&lt;</span><span class="pln">span id</span><span class="pun">=</span><span class="str">'userInfoGender'</span><span class="pun">&gt;&lt;/</span><span class="pln">span</span><span class="pun">&gt;</span><span class="pln"><font></font><font><font>
                br</font></font><font></font>
                strong </span><span class="typ">Location</span><span class="pun">:</span><span class="pln">
                </span><span class="pun">|</span><span class="pln">  </span><span class="pun">&lt;</span><span class="pln">span id</span><span class="pun">=</span><span class="str">'userInfoLocation'</span><span class="pun">&gt;&lt;/</span><span class="pln">span</span><span class="pun">&gt;</span><span class="pln">
        </span><span class="com">// /USER INFO</span><span class="pln">
</span></code>
</pre>

<p>
	Remember that the indents here are really important – if your indents are borked, Jade flat-out won't work. For reference, here's what your entire index.jade file should look like right now:
</p>

<h5><font><font>C:\node\nodetest2\views\index.jade</font></font></h5>
<pre class="prettyprint prettyprinted"><code><span class="pln">
</span><span class="kwd"><font><font>extends</font></font></span><span class="pln"><font><font> layout</font></font><font></font>
<font></font><font><font>
block content</font></font><font></font><font><font>
    h1</font></font></span><span class="pun"><font><font>=</font></font></span><span class="pln"><font><font> title</font></font><font></font><font><font>
    p </font></font></span><span class="typ"><font><font>Welcome</font></font></span><span class="pln"><font><font> to </font></font></span><span class="kwd"><font><font>our</font></font></span><span class="pln"><font><font> test</font></font><font></font>
<font></font>
    </span><span class="com"><font><font>// Wrapper</font></font></span><span class="pln">
    </span><span class="com"><font><font>#wrapper</font></font></span><span class="pln"><font></font>
<font></font>
        </span><span class="com"><font><font>// USER INFO</font></font></span><span class="pln">
        </span><span class="com"><font><font>#userInfo</font></font></span><span class="pln"><font><font>
            h2 </font></font></span><span class="typ"><font><font>User</font></font></span><span class="pln"> </span><span class="typ"><font><font>Info</font></font></span><span class="pln"><font></font><font><font>
            p</font></font><font></font><font><font>
                strong </font></font></span><span class="typ"><font><font>Name</font></font></span><span class="pun"><font><font>:</font></font></span><span class="pln">
                </span><span class="pun"><font><font>|</font></font></span><span class="pln">  </span><span class="pun"><font><font>&lt;</font></font></span><span class="pln"><font><font>span id</font></font></span><span class="pun"><font><font>=</font></font></span><span class="str"><font><font>'userInfoName'</font></font></span><span class="pun"><font><font>&gt;&lt;/</font></font></span><span class="pln"><font><font>span</font></font></span><span class="pun"><font><font>&gt;</font></font></span><span class="pln"><font></font><font><font>
                br</font></font><font></font><font><font>
                strong </font></font></span><span class="typ"><font><font>Age</font></font></span><span class="pun"><font><font>:</font></font></span><span class="pln">
                </span><span class="pun"><font><font>|</font></font></span><span class="pln">  </span><span class="pun"><font><font>&lt;</font></font></span><span class="pln"><font><font>span id</font></font></span><span class="pun"><font><font>=</font></font></span><span class="str"><font><font>'userInfoAge'</font></font></span><span class="pun"><font><font>&gt;&lt;/</font></font></span><span class="pln"><font><font>span</font></font></span><span class="pun"><font><font>&gt;</font></font></span><span class="pln"><font></font><font><font>
                br</font></font><font></font><font><font>
                strong </font></font></span><span class="typ"><font><font>Gender</font></font></span><span class="pun"><font><font>:</font></font></span><span class="pln">
                </span><span class="pun"><font><font>|</font></font></span><span class="pln">  </span><span class="pun"><font><font>&lt;</font></font></span><span class="pln"><font><font>span id</font></font></span><span class="pun"><font><font>=</font></font></span><span class="str"><font><font>'userInfoGender'</font></font></span><span class="pun"><font><font>&gt;&lt;/</font></font></span><span class="pln"><font><font>span</font></font></span><span class="pun"><font><font>&gt;</font></font></span><span class="pln"><font></font><font><font>
                br</font></font><font></font><font><font>
                strong </font></font></span><span class="typ"><font><font>Location</font></font></span><span class="pun"><font><font>:</font></font></span><span class="pln">
                </span><span class="pun"><font><font>|</font></font></span><span class="pln">  </span><span class="pun"><font><font>&lt;</font></font></span><span class="pln"><font><font>span id</font></font></span><span class="pun"><font><font>=</font></font></span><span class="str"><font><font>'userInfoLocation'</font></font></span><span class="pun"><font><font>&gt;&lt;/</font></font></span><span class="pln"><font><font>span</font></font></span><span class="pun"><font><font>&gt;</font></font></span><span class="pln">
        </span><span class="com"><font><font>// /USER INFO</font></font></span><span class="pln"><font></font>
<font></font>
        </span><span class="com"><font><font>// USER LIST</font></font></span><span class="pln"><font><font>
        h2 </font></font></span><span class="typ"><font><font>User</font></font></span><span class="pln"> </span><span class="typ"><font><font>List</font></font></span><span class="pln">
        </span><span class="com"><font><font>#userList</font></font></span><span class="pln"><font></font><font><font>
            table</font></font><font></font><font><font>
                thead</font></font><font></font><font><font>
                    th </font></font></span><span class="typ"><font><font>UserName</font></font></span><span class="pln"><font><font>
                    th </font></font></span><span class="typ"><font><font>Email</font></font></span><span class="pln"><font><font>
                    th </font></font></span><span class="typ"><font><font>Delete</font></font></span><span class="pun"><font><font>?</font></font></span><span class="pln"><font></font><font><font>
                tbody</font></font><font></font>
        </span><span class="com"><font><font>// /USER LIST</font></font></span><span class="pln"><font></font>
<font></font>
    </span><span class="com"><font><font>// /WRAPPER</font></font></span><span class="pln">
</span></code>
</pre>

<p>
	Got it? Cool. Save that file and let's hit our browser and take a look. Refresh <a href="http://localhost:3000/" target="_blank">http://localhost:3000</a> and now you'll see an unpopulated user info box floating over to the left. Click on the “test1” username in your table, and it should populate that box with Bob's info.
</p>

<p class="browsershot"><img src="./Creating a Simple RESTful Web App with Node.js, Express, and MongoDB _ Christopher Buecheler - Web, Writing, Cocktails and More_files/restful_web_app_screenshot_03.png" alt="Restful Web App Screenshot 3"></p>

<p>
	Pretty awesome. So now let's get some more users in there by doing some AJAX posting.
</p>

<h3>Part 7 - Adding Users</h3>

<p>
	The first thing we'll need a set of form fields with which to add a new user. So let's stick around in /views/index.jade for a bit and add that code. Right below our user list, but above the closing wrapper comment, add the following:
</p>

<h5><font><font>C:\node\nodetest2\views\index.jade</font></font></h5>
<pre class="prettyprint prettyprinted"><code><span class="pln">
        </span><span class="com"><font><font>// ADD USER </font></font></span><span class="pln"><font><font>
        h2 </font></font></span><span class="typ"><font><font>Add </font></font></span><span class="pln"> </span><span class="typ"><font><font>User </font></font></span><span class="pln">
        </span><span class="com"><font><font>#addUser</font></font></span><span class="pln"><font></font><font><font>
            fieldset</font></font><font></font>
                input</span><span class="com">#inputUserName(type='text', placeholder='Username')</span><span class="pln">
                input</span><span class="com">#inputUserEmail(type='text', placeholder='Email')</span><span class="pln"><font></font><font><font>
                br</font></font><font></font>
                input</span><span class="com">#inputUserFullname(type='text', placeholder='Full Name')</span><span class="pln">
                input</span><span class="com">#inputUserAge(type='text', placeholder='Age')</span><span class="pln"><font></font><font><font>
                br</font></font><font></font>
                input</span><span class="com">#inputUserLocation(type='text', placeholder='Location')</span><span class="pln">
                input</span><span class="com">#inputUserGender(type='text', placeholder='gender')</span><span class="pln"><font></font><font><font>
                br</font></font><font></font>
                button</span><span class="com">#btnAddUser Add User</span><span class="pln">
        </span><span class="com">// /ADD USER</span><span class="pln">
</span></code>
</pre>

<p>
	This is all pretty straightforward (yes, I'm using a couple of break tags, which are best avoided outside of text, but it's for the sake of expediency here). We've got text inputs for each piece of information we'll need to create a new user, and we've got a button to click on. Right now that button won't do anything, but that's what we're about to fix.
</p>

<p>
	This is the last time we'll need to touch our view file. Make sure it looks like this in your text editor:
</p>

<h5><font><font>C:\node\nodetest2\views\index.jade</font></font></h5>
<pre class="prettyprint prettyprinted"><code><span class="pln">
</span><span class="kwd"><font><font>extends</font></font></span><span class="pln"><font><font> layout</font></font><font></font>
<font></font><font><font>
block content</font></font><font></font><font><font>
    h1</font></font></span><span class="pun"><font><font>=</font></font></span><span class="pln"><font><font> title</font></font><font></font><font><font>
    p </font></font></span><span class="typ"><font><font>Welcome</font></font></span><span class="pln"><font><font> to </font></font></span><span class="kwd"><font><font>our</font></font></span><span class="pln"><font><font> test</font></font><font></font>
<font></font>
    </span><span class="com"><font><font>// Wrapper</font></font></span><span class="pln">
    </span><span class="com"><font><font>#wrapper</font></font></span><span class="pln"><font></font>
<font></font>
        </span><span class="com"><font><font>// USER INFO</font></font></span><span class="pln">
        </span><span class="com"><font><font>#userInfo</font></font></span><span class="pln"><font><font>
            h2 </font></font></span><span class="typ"><font><font>User</font></font></span><span class="pln"> </span><span class="typ"><font><font>Info</font></font></span><span class="pln"><font></font><font><font>
            p</font></font><font></font><font><font>
                strong </font></font></span><span class="typ"><font><font>Name</font></font></span><span class="pun"><font><font>:</font></font></span><span class="pln">
                </span><span class="pun"><font><font>|</font></font></span><span class="pln">  </span><span class="pun"><font><font>&lt;</font></font></span><span class="pln"><font><font>span id</font></font></span><span class="pun"><font><font>=</font></font></span><span class="str"><font><font>'userInfoName'</font></font></span><span class="pun"><font><font>&gt;&lt;/</font></font></span><span class="pln"><font><font>span</font></font></span><span class="pun"><font><font>&gt;</font></font></span><span class="pln"><font></font><font><font>
                br</font></font><font></font><font><font>
                strong </font></font></span><span class="typ"><font><font>Age</font></font></span><span class="pun"><font><font>:</font></font></span><span class="pln">
                </span><span class="pun"><font><font>|</font></font></span><span class="pln">  </span><span class="pun"><font><font>&lt;</font></font></span><span class="pln"><font><font>span id</font></font></span><span class="pun"><font><font>=</font></font></span><span class="str"><font><font>'userInfoAge'</font></font></span><span class="pun"><font><font>&gt;&lt;/</font></font></span><span class="pln"><font><font>span</font></font></span><span class="pun"><font><font>&gt;</font></font></span><span class="pln"><font></font><font><font>
                br</font></font><font></font><font><font>
                strong </font></font></span><span class="typ"><font><font>Gender</font></font></span><span class="pun"><font><font>:</font></font></span><span class="pln">
                </span><span class="pun"><font><font>|</font></font></span><span class="pln">  </span><span class="pun"><font><font>&lt;</font></font></span><span class="pln"><font><font>span id</font></font></span><span class="pun"><font><font>=</font></font></span><span class="str"><font><font>'userInfoGender'</font></font></span><span class="pun"><font><font>&gt;&lt;/</font></font></span><span class="pln"><font><font>span</font></font></span><span class="pun"><font><font>&gt;</font></font></span><span class="pln"><font></font><font><font>
                br</font></font><font></font><font><font>
                strong </font></font></span><span class="typ"><font><font>Location</font></font></span><span class="pun"><font><font>:</font></font></span><span class="pln">
                </span><span class="pun"><font><font>|</font></font></span><span class="pln">  </span><span class="pun"><font><font>&lt;</font></font></span><span class="pln"><font><font>span id</font></font></span><span class="pun"><font><font>=</font></font></span><span class="str"><font><font>'userInfoLocation'</font></font></span><span class="pun"><font><font>&gt;&lt;/</font></font></span><span class="pln"><font><font>span</font></font></span><span class="pun"><font><font>&gt;</font></font></span><span class="pln">
        </span><span class="com"><font><font>// /USER INFO</font></font></span><span class="pln"><font></font>
<font></font>
        </span><span class="com"><font><font>// USER LIST</font></font></span><span class="pln"><font><font>
        h2 </font></font></span><span class="typ"><font><font>User</font></font></span><span class="pln"> </span><span class="typ"><font><font>List</font></font></span><span class="pln">
        </span><span class="com"><font><font>#userList</font></font></span><span class="pln"><font></font><font><font>
            table</font></font><font></font><font><font>
                thead</font></font><font></font><font><font>
                    th </font></font></span><span class="typ"><font><font>UserName</font></font></span><span class="pln"><font><font>
                    th </font></font></span><span class="typ"><font><font>Email</font></font></span><span class="pln"><font><font>
                    th </font></font></span><span class="typ"><font><font>Delete</font></font></span><span class="pun"><font><font>?</font></font></span><span class="pln"><font></font><font><font>
                tbody</font></font><font></font>
        </span><span class="com"><font><font>// /USER LIST</font></font></span><span class="pln"><font></font>
<font></font>
        </span><span class="com"><font><font>// ADD USER </font></font></span><span class="pln"><font><font>
        h2 </font></font></span><span class="typ"><font><font>Add </font></font></span><span class="pln"> </span><span class="typ"><font><font>User </font></font></span><span class="pln">
        </span><span class="com"><font><font>#addUser</font></font></span><span class="pln"><font></font><font><font>
            fieldset</font></font><font></font><font><font>
                input</font></font></span><span class="com"><font><font>#inputUserName(type='text', placeholder='Username')</font></font></span><span class="pln"><font><font>
                input</font></font></span><span class="com"><font><font>#inputUserEmail(type='text', placeholder='Email')</font></font></span><span class="pln"><font></font><font><font>
                br</font></font><font></font><font><font>
                input</font></font></span><span class="com"><font><font>#inputUserFullname(type='text', placeholder='Full Name')</font></font></span><span class="pln"><font><font>
                input</font></font></span><span class="com"><font><font>#inputUserAge(type='text', placeholder='Age')</font></font></span><span class="pln"><font></font><font><font>
                br</font></font><font></font><font><font>
                input</font></font></span><span class="com"><font><font>#inputUserLocation(type='text', placeholder='Location')</font></font></span><span class="pln"><font><font>
                input</font></font></span><span class="com"><font><font>#inputUserGender(type='text', placeholder='gender')</font></font></span><span class="pln"><font></font><font><font>
                br</font></font><font></font><font><font>
                button</font></font></span><span class="com"><font><font>#btnAddUser Add User</font></font></span><span class="pln">
        </span><span class="com"><font><font>// /ADD USER</font></font></span><span class="pln"><font></font>
<font></font>
    </span><span class="com"><font><font>// /WRAPPER</font></font></span><span class="pln">
</span></code>
</pre>

<p>And like this in your browser:</p>

<p class="browsershot"><img src="./Creating a Simple RESTful Web App with Node.js, Express, and MongoDB _ Christopher Buecheler - Web, Writing, Cocktails and More_files/restful_web_app_screenshot_04.png" alt="Restful Web App Screenshot 4"></p>

<p>
	One last reminder: Jade is very touchy about tabs/spaces. If you're getting errors, check all of your indents and try restarting app.js. If everything looks right, you're good to go. Close index.jade, and open /routes/users.js – it's time to do some POSTing.
</p>

<p>
	Adding a user is really not too difficult. It's very similar to retrieving user info, except you're doing an insert() to the database instead of a find(). Below your user listing code (but above module.exports), you'll want to add the following:
</p>

<h5><font><font>C:\node\nodetest2\routes\users.js</font></font></h5>
<pre class="prettyprint prettyprinted"><code><span class="pln">
</span><span class="com"><font><font>/*</font></font><font></font>
 * POST to adduser.<font></font>
 */</span><span class="pln">
router</span><span class="pun">.</span><span class="pln">post</span><span class="pun">(</span><span class="str">'/adduser'</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">(</span><span class="pln">req</span><span class="pun">,</span><span class="pln"> res</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">var</span><span class="pln"> db </span><span class="pun">=</span><span class="pln"> req</span><span class="pun">.</span><span class="pln">db</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">var</span><span class="pln"> collection </span><span class="pun">=</span><span class="pln"> db</span><span class="pun">.</span><span class="kwd">get</span><span class="pun">(</span><span class="str">'userlist'</span><span class="pun">);</span><span class="pln">
    collection</span><span class="pun">.</span><span class="pln">insert</span><span class="pun">(</span><span class="pln">req</span><span class="pun">.</span><span class="pln">body</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">(</span><span class="pln">err</span><span class="pun">,</span><span class="pln"> result</span><span class="pun">){</span><span class="pln">
        res</span><span class="pun">.</span><span class="pln">send</span><span class="pun">(</span><span class="pln">
            </span><span class="pun">(</span><span class="pln">err </span><span class="pun">===</span><span class="pln"> </span><span class="kwd">null</span><span class="pun">)</span><span class="pln"> </span><span class="pun">?</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> msg</span><span class="pun">:</span><span class="pln"> </span><span class="str">''</span><span class="pln"> </span><span class="pun">}</span><span class="pln"> </span><span class="pun">:</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> msg</span><span class="pun">:</span><span class="pln"> err </span><span class="pun">}</span><span class="pln">
        </span><span class="pun">);</span><span class="pln">
    </span><span class="pun">});</span><span class="pln">
</span><span class="pun">});</span><span class="pln">
</span></code>
</pre>

<p>
	This basically just says “we're going to post some data (req.body), and you're going to insert it into our ‘userlist' collection in the database. If that goes well, return an empty string. If it goes poorly, return the error message that the database gives us.”
</p>

<p>
	For the purposes of this tutorial, that's really all there is to it. You can save /routes/users.js. That's all we need to do here. Now all that's left is making that new form/button do something. Head over to global.js and let's get started.
</p>

<p>
	First let's write our event catcher, up in the DOM Ready section, just below the user list name click. It's just one line of code:
</p>

<h5><font><font>C:\node\nodetest2\public\javascripts\global.js</font></font></h5>
<pre class="prettyprint prettyprinted"><code><span class="pln">
    </span><span class="com">// Add User button click</span><span class="pln">
    $</span><span class="pun">(</span><span class="str">'#btnAddUser'</span><span class="pun">).</span><span class="pln">on</span><span class="pun">(</span><span class="str">'click'</span><span class="pun">,</span><span class="pln"> addUser</span><span class="pun">);</span><span class="pln">
</span></code>
</pre>

<p>
	You'll note that we're calling an addUser function. Obviously, we'll need to build that function. This is going to be our largest single bit of code in this entire tutorial, because it's got quite a bit going on. It has to do some rudimentary form validation and then, if the form's all filled out, compile the data and POST it via AJAX to our adduser service.
</p>

<p>
	This is a big function. I've commented it thoroughly to show what's going on. Add this at the bottom of global.js:
</p>

<h5><font><font>C:\node\nodetest2\public\javascripts\global.js</font></font></h5>
<pre class="prettyprint prettyprinted"><code><span class="pln">
</span><span class="com">// Add User</span><span class="pln">
</span><span class="kwd">function</span><span class="pln"> addUser</span><span class="pun">(</span><span class="kwd">event</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">event</span><span class="pun">.</span><span class="pln">preventDefault</span><span class="pun">();</span><span class="pln"><font></font>
<font></font>
    </span><span class="com">// Super basic validation - increase errorCount variable if any fields are blank</span><span class="pln">
    </span><span class="kwd">var</span><span class="pln"> errorCount </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
    $</span><span class="pun">(</span><span class="str">'#addUser input'</span><span class="pun">).</span><span class="pln">each</span><span class="pun">(</span><span class="kwd">function</span><span class="pun">(</span><span class="pln">index</span><span class="pun">,</span><span class="pln"> val</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">$</span><span class="pun">(</span><span class="kwd">this</span><span class="pun">).</span><span class="pln">val</span><span class="pun">()</span><span class="pln"> </span><span class="pun">===</span><span class="pln"> </span><span class="str">''</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> errorCount</span><span class="pun">++;</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
    </span><span class="pun">});</span><span class="pln"><font></font>
<font></font>
    </span><span class="com">// Check and make sure errorCount's still at zero</span><span class="pln">
    </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">errorCount </span><span class="pun">===</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><font></font>
<font></font>
        </span><span class="com">// If it is, compile all user info into one object</span><span class="pln">
        </span><span class="kwd">var</span><span class="pln"> newUser </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            </span><span class="str">'username'</span><span class="pun">:</span><span class="pln"> $</span><span class="pun">(</span><span class="str">'#addUser fieldset input#inputUserName'</span><span class="pun">).</span><span class="pln">val</span><span class="pun">(),</span><span class="pln">
            </span><span class="str">'email'</span><span class="pun">:</span><span class="pln"> $</span><span class="pun">(</span><span class="str">'#addUser fieldset input#inputUserEmail'</span><span class="pun">).</span><span class="pln">val</span><span class="pun">(),</span><span class="pln">
            </span><span class="str">'fullname'</span><span class="pun">:</span><span class="pln"> $</span><span class="pun">(</span><span class="str">'#addUser fieldset input#inputUserFullname'</span><span class="pun">).</span><span class="pln">val</span><span class="pun">(),</span><span class="pln">
            </span><span class="str">'age'</span><span class="pun">:</span><span class="pln"> $</span><span class="pun">(</span><span class="str">'#addUser fieldset input#inputUserAge'</span><span class="pun">).</span><span class="pln">val</span><span class="pun">(),</span><span class="pln">
            </span><span class="str">'location'</span><span class="pun">:</span><span class="pln"> $</span><span class="pun">(</span><span class="str">'#addUser fieldset input#inputUserLocation'</span><span class="pun">).</span><span class="pln">val</span><span class="pun">(),</span><span class="pln">
            </span><span class="str">'gender'</span><span class="pun">:</span><span class="pln"> $</span><span class="pun">(</span><span class="str">'#addUser fieldset input#inputUserGender'</span><span class="pun">).</span><span class="pln">val</span><span class="pun">()</span><span class="pln">
        </span><span class="pun">}</span><span class="pln"><font></font>
<font></font>
        </span><span class="com">// Use AJAX to post the object to our adduser service</span><span class="pln">
        $</span><span class="pun">.</span><span class="pln">ajax</span><span class="pun">({</span><span class="pln">
            type</span><span class="pun">:</span><span class="pln"> </span><span class="str">'POST'</span><span class="pun">,</span><span class="pln">
            data</span><span class="pun">:</span><span class="pln"> newUser</span><span class="pun">,</span><span class="pln">
            url</span><span class="pun">:</span><span class="pln"> </span><span class="str">'/users/adduser'</span><span class="pun">,</span><span class="pln">
            dataType</span><span class="pun">:</span><span class="pln"> </span><span class="str">'JSON'</span><span class="pln">
        </span><span class="pun">}).</span><span class="kwd">done</span><span class="pun">(</span><span class="kwd">function</span><span class="pun">(</span><span class="pln"> response </span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><font></font>
<font></font>
            </span><span class="com">// Check for successful (blank) response</span><span class="pln">
            </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">response</span><span class="pun">.</span><span class="pln">msg </span><span class="pun">===</span><span class="pln"> </span><span class="str">''</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><font></font>
<font></font>
                </span><span class="com">// Clear the form inputs</span><span class="pln">
                $</span><span class="pun">(</span><span class="str">'#addUser fieldset input'</span><span class="pun">).</span><span class="pln">val</span><span class="pun">(</span><span class="str">''</span><span class="pun">);</span><span class="pln"><font></font>
<font></font>
                </span><span class="com">// Update the table</span><span class="pln">
                populateTable</span><span class="pun">();</span><span class="pln"><font></font>
<font></font>
            </span><span class="pun">}</span><span class="pln">
            </span><span class="kwd">else</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><font></font>
<font></font>
                </span><span class="com">// If something goes wrong, alert the error message that our service returned</span><span class="pln">
                alert</span><span class="pun">(</span><span class="str">'Error: '</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> response</span><span class="pun">.</span><span class="pln">msg</span><span class="pun">);</span><span class="pln"><font></font>
<font></font>
            </span><span class="pun">}</span><span class="pln">
        </span><span class="pun">});</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">else</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        </span><span class="com">// If errorCount is more than 0, error out</span><span class="pln">
        alert</span><span class="pun">(</span><span class="str">'Please fill in all fields'</span><span class="pun">);</span><span class="pln">
        </span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">false</span><span class="pun">;</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
</span><span class="pun">};</span><span class="pln">
</span></code>
</pre>

<p>
	I recommend typing all that out instead of cutting and pasting it – it'll help you see what's really going on in a way that just scanning it with your eyes won't. But either way, get that into your javascript and save the file. Now remember to <strong>restart your node app</strong> and then refresh <a href="http://localhost:3000/" target="_blank">http://localhost:3000</a> … you'll see the same thing you saw before, except now that form should work! Let's fill in some info.
</p>

<p class="browsershot"><img src="./Creating a Simple RESTful Web App with Node.js, Express, and MongoDB _ Christopher Buecheler - Web, Writing, Cocktails and More_files/restful_web_app_screenshot_05.png" alt="Restful Web App Screenshot 5"></p>

<p>
	Click add, and the form should submit, the data should be sent off to the database, and the table should refresh to show this fact. Click on your new username in that table, and you'll get your new user info in the info box. You'll note that all of this happened without any kind of a page refresh, which is what we're looking for here.
</p>

<p class="browsershot"><img src="./Creating a Simple RESTful Web App with Node.js, Express, and MongoDB _ Christopher Buecheler - Web, Writing, Cocktails and More_files/restful_web_app_screenshot_06.png" alt="Restful Web App Screenshot 6"></p>

<p>
	Go ahead and create a few more users. We're going to be getting rid of a couple of ‘em in the next section.
</p>

<h3>Part 8 - Deleting Users</h3>

<p>
	This is easier than adding users, but it's largely the same process: update our route file and update global.js … we don't even have to touch index.jade because we already put our delete links in there. Good times.
</p>

<p>
	Let's start with the route file. <strong>Update:</strong> the syntax has changed since I first posted this tutorial. The <strong>NEW</strong>, correct syntax is shown here. Open /routes/users.js and add the following to the bottom, just above module.exports:
</p>

<h5><font><font>C:\node\nodetest2\routes\users.js</font></font></h5>
<pre class="prettyprint prettyprinted"><code><span class="pln">
</span><span class="com"><font><font>/*</font></font><font></font>
 * DELETE to deleteuser.<font></font>
 */</span><span class="pln">
router</span><span class="pun">.</span><span class="kwd">delete</span><span class="pun">(</span><span class="str">'/deleteuser/:id'</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">(</span><span class="pln">req</span><span class="pun">,</span><span class="pln"> res</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">var</span><span class="pln"> db </span><span class="pun">=</span><span class="pln"> req</span><span class="pun">.</span><span class="pln">db</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">var</span><span class="pln"> collection </span><span class="pun">=</span><span class="pln"> db</span><span class="pun">.</span><span class="kwd">get</span><span class="pun">(</span><span class="str">'userlist'</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">var</span><span class="pln"> userToDelete </span><span class="pun">=</span><span class="pln"> req</span><span class="pun">.</span><span class="kwd">params</span><span class="pun">.</span><span class="pln">id</span><span class="pun">;</span><span class="pln">
    collection</span><span class="pun">.</span><span class="pln">remove</span><span class="pun">({</span><span class="pln"> </span><span class="str">'_id'</span><span class="pln"> </span><span class="pun">:</span><span class="pln"> userToDelete </span><span class="pun">},</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">(</span><span class="pln">err</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        res</span><span class="pun">.</span><span class="pln">send</span><span class="pun">((</span><span class="pln">err </span><span class="pun">===</span><span class="pln"> </span><span class="kwd">null</span><span class="pun">)</span><span class="pln"> </span><span class="pun">?</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> msg</span><span class="pun">:</span><span class="pln"> </span><span class="str">''</span><span class="pln"> </span><span class="pun">}</span><span class="pln"> </span><span class="pun">:</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> msg</span><span class="pun">:</span><span class="str">'error: '</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> err </span><span class="pun">});</span><span class="pln">
    </span><span class="pun">});</span><span class="pln">
</span><span class="pun">});</span><span class="pln">
</span></code>
</pre>

<p>
	This is pretty straightforward – we pass in an ID parameter (so the URI we'll be referencing will be /deleteuser/12345 for example, and we reference it in the code with req.params.id), and MongoDB matches it up with the unique _id field that it generates for every entry in a collection, and nukes that entry from orbit. Just like our add user routine, if all goes well it returns a blank string, and if things don't work out it sends back the error message from MongoDB.
</p>

<p>
	Save /routes/users.js and then we'll wire stuff up in the JavaScript. Let's move back to global.js to finish things up. We've already populated each delete link with a rel attribute that contains the id. It's in this line from global.js:
</p>

<h5><font><font>C:\node\nodetest2\public\javascripts\global.js</font></font></h5>
<pre class="prettyprint prettyprinted"><code><span class="pln">
tableContent </span><span class="pun">+=</span><span class="pln"> </span><span class="str">'&lt;td&gt;&lt;a href="#" class="linkdeleteuser" rel="'</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">_id </span><span class="pun">+</span><span class="pln"> </span><span class="str">'"&gt;delete&lt;/a&gt;&lt;/td&gt;'</span><span class="pun">;</span><span class="pln">
</span></code>
</pre>

<p>
	Now we're going to add a quick delete routine in our DOM Ready section:
</p>

<h5><font><font>C:\node\nodetest2\public\javascripts\global.js</font></font></h5>
<pre class="prettyprint prettyprinted"><code><span class="pln">
    </span><span class="com">// Delete User link click</span><span class="pln">
    $</span><span class="pun">(</span><span class="str">'#userList table tbody'</span><span class="pun">).</span><span class="pln">on</span><span class="pun">(</span><span class="str">'click'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'td a.linkdeleteuser'</span><span class="pun">,</span><span class="pln"> deleteUser</span><span class="pun">);</span><span class="pln">
</span></code>
</pre>

<p>
	Note the syntax we're using: when working with jQuery's ‘on' method, in order to capture dynamically inserted links, you need to reference a static element on the page first. That's why our selector is the table's tbody element – which remains constant regardless of adding or removing users – and then we're specifying the specific links we're trying to catch in the .on parameters.
</p>

<p>
	Let's build that deleteUser function down at the bottom of our file:
</p>

<h5><font><font>C:\node\nodetest2\public\javascripts\global.js</font></font></h5>
<pre class="prettyprint prettyprinted"><code><span class="pln">
</span><span class="com">// Delete User</span><span class="pln">
</span><span class="kwd">function</span><span class="pln"> deleteUser</span><span class="pun">(</span><span class="kwd">event</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><font></font>
<font></font>
    </span><span class="kwd">event</span><span class="pun">.</span><span class="pln">preventDefault</span><span class="pun">();</span><span class="pln"><font></font>
<font></font>
    </span><span class="com">// Pop up a confirmation dialog</span><span class="pln">
    </span><span class="kwd">var</span><span class="pln"> confirmation </span><span class="pun">=</span><span class="pln"> confirm</span><span class="pun">(</span><span class="str">'Are you sure you want to delete this user?'</span><span class="pun">);</span><span class="pln"><font></font>
<font></font>
    </span><span class="com">// Check and make sure the user confirmed</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">confirmation </span><span class="pun">===</span><span class="pln"> </span><span class="kwd">true</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><font></font>
<font></font>
        </span><span class="com">// If they did, do our delete</span><span class="pln">
        $</span><span class="pun">.</span><span class="pln">ajax</span><span class="pun">({</span><span class="pln">
            type</span><span class="pun">:</span><span class="pln"> </span><span class="str">'DELETE'</span><span class="pun">,</span><span class="pln">
            url</span><span class="pun">:</span><span class="pln"> </span><span class="str">'/users/deleteuser/'</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> $</span><span class="pun">(</span><span class="kwd">this</span><span class="pun">).</span><span class="pln">attr</span><span class="pun">(</span><span class="str">'rel'</span><span class="pun">)</span><span class="pln">
        </span><span class="pun">}).</span><span class="kwd">done</span><span class="pun">(</span><span class="kwd">function</span><span class="pun">(</span><span class="pln"> response </span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><font></font>
<font></font>
            </span><span class="com">// Check for a successful (blank) response</span><span class="pln">
            </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">response</span><span class="pun">.</span><span class="pln">msg </span><span class="pun">===</span><span class="pln"> </span><span class="str">''</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            </span><span class="pun">}</span><span class="pln">
            </span><span class="kwd">else</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
                alert</span><span class="pun">(</span><span class="str">'Error: '</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> response</span><span class="pun">.</span><span class="pln">msg</span><span class="pun">);</span><span class="pln">
            </span><span class="pun">}</span><span class="pln"><font></font>
<font></font>
            </span><span class="com">// Update the table</span><span class="pln">
            populateTable</span><span class="pun">();</span><span class="pln"><font></font>
<font></font>
        </span><span class="pun"><font><font>});</font></font></span><span class="pln"><font></font>
<font></font>
    </span><span class="pun"><font><font>}</font></font></span><span class="pln">
    </span><span class="kwd"><font><font>else</font></font></span><span class="pln"> </span><span class="pun"><font><font>{</font></font></span><span class="pln"><font></font>
<font></font>
        </span><span class="com">// If they said no to the confirm, do nothing</span><span class="pln">
        </span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">false</span><span class="pun">;</span><span class="pln"><font></font>
<font></font>
    </span><span class="pun">}</span><span class="pln"><font></font>
<font></font>
</span><span class="pun"><font><font>};</font></font></span><span class="pln">
</span></code>
</pre>

<p>
	Remember to <strong>restart your node server</strong> and then hit http://localhost:3000 to test it out. This one's more simple than the addUser function. It does a quick JavaScript confirm:
</p>

<p class="browsershot"><img src="./Creating a Simple RESTful Web App with Node.js, Express, and MongoDB _ Christopher Buecheler - Web, Writing, Cocktails and More_files/restful_web_app_screenshot_07.png" alt="Restful Web App Screenshot7"></p>

<p>
	If the user's sure they want to delete, it just hits our delete service and passes it the ID, then it updates the table to show that the user is now gone.
</p>

<p class="browsershot"><img src="./Creating a Simple RESTful Web App with Node.js, Express, and MongoDB _ Christopher Buecheler - Web, Writing, Cocktails and More_files/restful_web_app_screenshot_08.png" alt="Restful Web App Screenshot 8"></p>

<p>
	That's it. We've got delete working. You can now add, view, and delete as many users as you'd like. Since this tutorial's already the length of a dictionary, we're going to skip updating, but hopefully you have a solid idea of how to do that. First you'd GET the info and populate a form with it, then you'd PUT on submission of the form (see the beginning of this tutorial for info on POST vs. PUT), and update the table.
</p>

<p>
	Actually, that's not a bad exercise: you should try to add updating user info to this page and see if you can get it working. You'll need to edit /views/index.jade, /routes/users.js, /app.js, and /public/javascripts/global.js just like for adding and deleting.
</p>


<h3>Conclusion</h3>

<p>
	Well, there we have it. We've gotten through yet another big-ass NodeJS tutorial together. I hope everything worked!
</p>

<p>
	This is obviously an incredibly rudimentary RESTful web app. It gives no thought to performance or to “what happens when my table has 1,000 users instead of 10?”-type questions. It also doesn't worry a lot about flexibility, maintainability, or future additions. The purpose was merely to get you up to speed with single-page, ajax-driven data manipulation in Node / Express / MongoDB. I hope it's accomplished that!
</p>

<p>
	For more on REST and the best ways to approach it, I recommend the following articles:
</p>

<ul>
	<li><a href="http://www.vinaysahni.com/best-practices-for-a-pragmatic-restful-api" target="_blank">Best Practices for Designing a Pragmatic RESTful API</a> by Vinay Sahni</li>
	<li><a href="http://madhatted.com/2013/3/19/suggested-rest-api-practices" target="_blank">Suggested REST API Practices (2013)</a> by Matthew Beale</li>
</ul>

<h3>Thanks &amp; Info</h3>

<p>
	I once again owe a debt of gratitude to a few people and would be remiss if I didn't give ‘em some links!
</p>

<ul>
	<li><a href="https://twitter.com/azat_co" target="_blank">Azat Mardanov</a>, whose tutorial <a href="http://webapplog.com/tutorial-node-js-and-mongodb-json-rest-api-server-with-mongoskin-and-express-js/" target="_blank">Node.js and MongoDB JSON REST API server with Mongoskin and Express.js</a> helped me form some basic concepts for this one.</li>
	<li><a href="https://twitter.com/rockbot" "raquel="" velez="" on="" twitter"="" target="_blank">Raquel Velez</a> (who is now a part of the <a href="https://npmjs.org/" target="_blank">NPM team</a>), who got me started on this whole Node thing.</li>
	<li>The fine folks who helped proof this article:
		<ul>
			<li><a href="https://twitter.com/jordanforeman" target="_blank">Jordan Foreman</a></li>
			<li><a href="https://twitter.com/RogerKeizer" target="_blank"><font><font>Roger Keizer</font></font></a></li>
		</ul>
	</li>
	<li>All the folks who commented on my previous tutorial. The response from across the web was amazing and really made me want to do more. I'm hoping to do video versions of that one (and this one) soon. Looking forward to hearing your thoughts on this tutorial!</li>
</ul>

<p>
	This article was written in <a href="http://daringfireball.net/projects/markdown/" target="_blank">Markdown</a> over at <a href="http://editorially.com/" target="_blank">Editorially</a> before being transferred to my HTML editor for final tweaking.
</p>


<h4>About the author</h4>

<p>
    <a href="http://cwbuecheler.com/">Christopher Buecheler</a> is an autodidact polymath, which is an <em>incredibly</em> pretentious way of saying that he's a jack of all trades who didn't like college. By day he's a <a href="http://cwbuecheler.com/web/">front-end developer</a> for a small San Francisco startup. By night <a href="http://cwbuecheler.com/writing/">he's a popular novelist</a>, with four books released. He also is an <a href="http://www.huffingtonpost.com/tony-sachs/a-cocktail-safari-with-ta_b_867015.html" target="_blank">award-winning amateur mixologist</a> who <a href="http://cwbuecheler.com/writing/#nonfiction">writes cocktail articles for Primer Magazine</a> and <a href="http://drinkshouts.com/" target="_blank">runs a cocktail blog</a>, and he brews beer on occasion. He follows the NBA avidly and the NFL casually (and sometimes glances at MLB). He lives in Providence, Rhode Island, with his awesome French wife and their two cats. He is trying to learn French but wishes he could just download it from the Matrix.
</p>

    <div id="disqus_thread" class="disqusbox"><iframe id="dsq-2" data-disqus-uid="2" allowtransparency="true" frameborder="0" scrolling="no" tabindex="0" title="Disqus" width="100%" src="./Creating a Simple RESTful Web App with Node.js, Express, and MongoDB _ Christopher Buecheler - Web, Writing, Cocktails and More_files/saved_resource.html" style="width: 100% !important; border: none !important; overflow: hidden !important; height: 10624px !important;" horizontalscrolling="no" verticalscrolling="no"></iframe><iframe id="dsq-indicator-north" data-disqus-uid="indicator-north" allowtransparency="true" frameborder="0" scrolling="no" tabindex="0" title="Disqus" style="width: 600px !important; border: none !important; overflow: hidden !important; top: 0px !important; min-width: 600px !important; max-width: 600px !important; position: fixed !important; z-index: 2147483646 !important; height: 29px !important; min-height: 29px !important; max-height: 29px !important; display: none !important;"></iframe><iframe id="dsq-indicator-south" data-disqus-uid="indicator-south" allowtransparency="true" frameborder="0" scrolling="no" tabindex="0" title="Disqus" style="width: 600px !important; border: none !important; overflow: hidden !important; bottom: 0px !important; min-width: 600px !important; max-width: 600px !important; position: fixed !important; z-index: 2147483646 !important; height: 29px !important; min-height: 29px !important; max-height: 29px !important; display: none !important;"></iframe></div>
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'cwbuecheler'; // required: replace example with your forum shortname
		var disqus_title = 'Creating a Simple RESTful Web App with Node.js, Express, and MongoDB';
		var disqus_identifier = ' /web/tutorials/2014/restful-web-app-node-express-mongodb/';

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the &lt;a href="http://disqus.com/?ref_noscript"&gt;comments powered by Disqus.&lt;/a&gt;</noscript>
    


			</article>
			<!-- /CONTENT -->

		<!-- SIDEBAR -->
		<aside class="sidebar clearfix">

							<div class="sbwidget ad">
					<h3>Advertisement</h3>
					<script async="" src="http://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
					<!-- CWB Node top 300 -->
					<ins class="adsbygoogle" style="display:inline-block;width:300px;height:250px" data-ad-client="ca-pub-8948395083004413" data-ad-slot="3616894906"></ins>
					<script>
					(adsbygoogle = window.adsbygoogle || []).push({});
					</script>
				</div>
			
			<div class="wrapper clearfix">
				<div class="left">

					<!-- CURRENT PROJECTS -->
					<div class="sbwidget currproj">
						<h3>Current Projects</h3>
						<ul>
							<li>
								<h4><a href="http://cwbuecheler.com/writing/#pulse">Pulse</a></h4>
								<p>
									<strong>Version:</strong> 3nd Draft<br>
									<strong>Status:</strong> Finished, Out to Readers
								</p>
							</li>
							<li>
								<h4><a href="http://cwbuecheler.com/writing/#elixir">Elixir</a></h4>
								<p>
									<strong>Version:</strong> Manuscript<br>
									<strong>Status:</strong> Shopping to Publishers
								</p>
							</li>
						</ul>
					</div>
					<!-- /CURRENT PROJECTS -->

					<!-- BUY MY BOOKS -->
					<div class="sbwidget buymybooks clearfix">
						<h3>Get My Books</h3>
						<ul class="clearfix">
							<li><a href="http://brokengodmachine.com/getitnow.php" target="_blank" class="tbgm ir">The Broken God Machine</a> $2.99</li>
							<li><a href="http://iiamtrilogy.com/tbtb/" target="_blank" class="tbtb ir">The Blood That Bonds</a> FREE</li>
							<li><a href="http://iiamtrilogy.com/bloodhunt/" target="_blank" class="bh ir">Blood Hunt</a> $2.99</li>
							<li><a href="http://iiamtrilogy.com/tcs/" target="_blank" class="tcots ir">The Children of the Sun</a> $2.99</li>
							<li><a href="http://iiamtrilogy.com/trilogy/" target="_blank" class="trilogy ir">The II AM Trilogy Collection</a> $4.99</li>
						</ul>
					</div>
					<!-- /BUY MY BOOKS -->

					<!-- GET MY NEWSLETTER -->
					<div class="sbwidget newsletter">
						<h3>Subscribe to my Newsletter</h3>
						<p>
							It's free, arrives bi-monthly, and contains no spam or ads.
							<a href="http://cwbuecheler.com/newsletter/">Subscribe now</a>
						</p>
					</div>
					<!-- /GET MY NEWSLETTER -->

				</div>

				<div class="right">

					<!-- TWITTER -->
					<div class="sbwidget twitterwidget" data-twttr-id="twttr-sandbox-0">
						<h3>Follow Me On Twitter</h3>
						<iframe id="twitter-widget-0" scrolling="no" frameborder="0" allowtransparency="true" class="twitter-timeline twitter-timeline-rendered" allowfullscreen="" style="border: none; max-width: 100%; min-width: 180px; margin: 0px; padding: 0px; display: inline-block; position: static; visibility: visible; width: 358px;" title="Twitter Timeline" height="400"></iframe>
		<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+"://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
					</div>
					<!-- /TWITTER -->

					<!-- FACEBOOK -->
					<div class="sbwidget facebookwidget">
						<h3>Like Me On Facebook</h3>
						<div class="fb-like-box fb_iframe_widget" data-href="https://www.facebook.com/pages/Christopher-Buecheler/217775071566560" data-width="298" data-height="500" data-colorscheme="light" data-show-faces="true" data-header="false" data-stream="true" data-show-border="true" fb-xfbml-state="rendered" fb-iframe-plugin-query="app_id=217798258378864&amp;color_scheme=light&amp;container_width=298&amp;header=false&amp;height=500&amp;href=https%3A%2F%2Fwww.facebook.com%2Fpages%2FChristopher-Buecheler%2F217775071566560&amp;locale=en_US&amp;sdk=joey&amp;show_border=true&amp;show_faces=true&amp;stream=true&amp;width=298"><span style="vertical-align: bottom; width: 298px; height: 500px;"><iframe name="f214461e24" width="298px" height="500px" frameborder="0" allowtransparency="true" allowfullscreen="true" scrolling="no" title="fb:like_box Facebook Social Plugin" src="./Creating a Simple RESTful Web App with Node.js, Express, and MongoDB _ Christopher Buecheler - Web, Writing, Cocktails and More_files/like_box.html" style="border: none; visibility: visible; width: 298px; height: 500px;" class=""></iframe></span></div>
					</div>
					<!-- /FACEBOOK -->

				</div>
			</div>

		</aside>
		<!-- /SIDEBAR -->
		</div>
		<!-- /CONTENT & SIDEBAR WRAP -->

		

		<!-- FOOTER -->
		<footer class="clearfix">

			<p>Design • Code • Content © <span id="copydate">2015</span> Christopher Buecheler</p>

			<!-- MAIN MENU -->
			<h3>Site Menu</h3>
			<nav role="navigation" class="footernav clearfix">
				<ul class="clearfix">
					<li><a href="http://cwbuecheler.com/" class="on"><font><font>Home</font></font></a></li>
					<li><a href="http://cwbuecheler.com/web/"><font><font>Web</font></font></a></li>
					<li><a href="http://cwbuecheler.com/writing/"><font><font>Writing</font></font></a></li>
					<li><a href="http://cwbuecheler.com/cocktails/"><font><font>Cocktails</font></font></a></li>
					<li><a href="http://cwbuecheler.com/beer/"><font><font>Beer</font></font></a></li>
					<li><a href="http://cwbuecheler.com/videogames/"><font><font>Video Games</font></font></a></li>
					<li><a href="http://cwbuecheler.com/music/"><font><font>Music</font></font></a></li>
					<li><a href="http://cwbuecheler.com/sports/"><font><font>Sports</font></font></a></li>
					<li><a href="http://cwbuecheler.com/contact/"><font><font>Contact</font></font></a></li>
				</ul>
			</nav>
			<!-- /MAIN MENU -->

			<!-- FOOTER LINKS -->
			<h3>Built With</h3>
			<nav role="naviagtion" class="footerlinks clearfix">
				<ul>
					<li><a href="http://html5boilerplate.com/" target="_blank">HTML5 Boilerplate</a></li>
					<li><a href="http://www.css3.info/" target="_blank">CSS3</a></li>
					<li><a href="http://jquery.com/" target="_blank">jQuery</a></li>
					<li><a href="http://sass-lang.com/" target="_blank">SASS</a></li>
					<li><a href="http://www.abookapart.com/products/responsive-web-design" target="_blank">Responsive Design</a></li>
				</ul>
			</nav>
			<!-- /FOOTER LINKS -->

		</footer>
		<!-- /FOOTER -->

	</div>
	<!-- /BASE CONTAINER -->

</div>
<!-- /WRAP -->

<script src="./Creating a Simple RESTful Web App with Node.js, Express, and MongoDB _ Christopher Buecheler - Web, Writing, Cocktails and More_files/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="/_js/jquery-1.10.2.min.js"><\/script>')</script>

<script src="./Creating a Simple RESTful Web App with Node.js, Express, and MongoDB _ Christopher Buecheler - Web, Writing, Cocktails and More_files/global_min.js"></script>

<div id="fb-root" class=" fb_reset"><div style="position: absolute; top: -10000px; height: 0px; width: 0px;"><div><iframe name="fb_xdm_frame_http" frameborder="0" allowtransparency="true" allowfullscreen="true" scrolling="no" id="fb_xdm_frame_http" aria-hidden="true" title="Facebook Cross Domain Communication Frame" tabindex="-1" src="./Creating a Simple RESTful Web App with Node.js, Express, and MongoDB _ Christopher Buecheler - Web, Writing, Cocktails and More_files/1ldYU13brY_.html" style="border: none;"></iframe><iframe name="fb_xdm_frame_https" frameborder="0" allowtransparency="true" allowfullscreen="true" scrolling="no" id="fb_xdm_frame_https" aria-hidden="true" title="Facebook Cross Domain Communication Frame" tabindex="-1" src="./Creating a Simple RESTful Web App with Node.js, Express, and MongoDB _ Christopher Buecheler - Web, Writing, Cocktails and More_files/1ldYU13brY_(1).html" style="border: none;"></iframe></div></div><div style="position: absolute; top: -10000px; height: 0px; width: 0px;"><div></div></div></div>
<script>(function(d, s, id) { var js, fjs = d.getElementsByTagName(s)[0]; if (d.getElementById(id)) return; js = d.createElement(s); js.id = id; js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&appId=217798258378864&version=v2.0"; fjs.parentNode.insertBefore(js, fjs); }(document, 'script', 'facebook-jssdk'));</script>

<script type="text/javascript">
var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-18369108-1']);
_gaq.push(['_trackPageview']);
(function() {
var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();
</script>

<script>var gsClickPrintsGlobal = {}; var gsClientID = 27;(function(){function e(){var e=document.createElement("script");e.type="text/javascript";e.async=true;e.src="//service.goldenspear.com/content/_js/clickprints/clickprints.min.js?v=2015.05.26";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}if(window.attachEvent)window.attachEvent("onload",e);else window.addEventListener("load",e,false)})()</script>


<div id="goog-gt-tt" class="skiptranslate" dir="ltr"><div style="padding: 8px;"><div><div class="logo"><img src="./Creating a Simple RESTful Web App with Node.js, Express, and MongoDB _ Christopher Buecheler - Web, Writing, Cocktails and More_files/translate-32.png" width="20" height="20"></div></div></div><div class="top" style="padding: 8px; float: left; width: 100%;"><h1 class="title gray">Original text</h1></div><div class="middle" style="padding: 8px;"><div class="original-text"></div></div><div class="bottom" style="padding: 8px;"><div class="activity-links"><span class="activity-link">Contribute a better translation</span><span class="activity-link"></span></div><div class="started-activity-container"><hr style="color: #CCC; background-color: #CCC; height: 1px; border: none;"><div class="activity-root"></div></div></div><div class="status-message" style="display: none;"></div></div><iframe id="rufous-sandbox" scrolling="no" frameborder="0" allowtransparency="true" style="display: none;"></iframe></body></html>